<!DOCTYPE html>
<html lang="ru">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=1">
<title>Pancrea-Score ‚Äî –û—Å—Ç—Ä—ã–π –ü–∞–Ω–∫—Ä–µ–∞—Ç–∏—Ç</title>
<style>
*{box-sizing:border-box;margin:0;padding:0}
:root{
  --bg:#06090f;--bg2:#0c1422;--bg3:#111e2e;--bd:#1a2d44;--bd2:#2a4060;
  --t:#ddeeff;--t2:#7090b0;--t3:#304560;
  --c:#00dfc0;--g:#10c98a;--y:#f5a623;--r:#ef4343;--b:#4a9eff;
}
html,body{background:var(--bg);color:var(--t);font-family:-apple-system,BlinkMacSystemFont,'Segoe UI',sans-serif;font-size:15px;min-height:100vh}
.hdr{background:var(--bg2);border-bottom:1px solid var(--bd);padding:10px 14px;display:flex;align-items:center;gap:10px;position:sticky;top:0;z-index:99}
.logo{width:34px;height:34px;background:var(--c);border-radius:8px;display:flex;align-items:center;justify-content:center;font-size:17px;flex-shrink:0}
.logo-t{font-size:14px;font-weight:700;color:var(--c)}
.logo-s{font-size:10px;color:var(--t3);text-transform:uppercase;letter-spacing:.07em}
.dbadge{margin-left:auto;padding:4px 11px;border-radius:20px;font-size:11px;font-weight:700;border:1px solid;white-space:nowrap}
.ok{background:#10c98a18;border-color:#10c98a55;color:var(--g)}
.warn{background:#f5a62318;border-color:#f5a62355;color:var(--y)}
.snav{background:var(--bg2);border-bottom:1px solid var(--bd);display:flex;overflow-x:auto;padding:0 8px}
.snav::-webkit-scrollbar{display:none}
.sb{padding:9px 10px;border:none;background:transparent;color:var(--t3);font-size:12px;cursor:pointer;border-bottom:2px solid transparent;white-space:nowrap;display:flex;align-items:center;gap:4px;font-family:inherit;transition:.15s}
.sb.active{color:var(--c);border-bottom-color:var(--c);font-weight:600}
.sb.done{color:var(--g)}
.sb.locked{opacity:.3;cursor:not-allowed}
.snum{width:17px;height:17px;border-radius:50%;background:var(--bd);color:var(--t3);font-size:9px;font-weight:700;display:flex;align-items:center;justify-content:center;flex-shrink:0}
.sb.active .snum{background:var(--c);color:#000}
.sb.done .snum{background:var(--g);color:#000}
.wrap{padding:14px;max-width:700px;margin:0 auto}
.card{background:var(--bg2);border:1px solid var(--bd);border-radius:10px;overflow:hidden;margin-bottom:12px}
.ch{background:var(--bg3);border-bottom:1px solid var(--bd);padding:9px 13px;display:flex;align-items:center;gap:7px}
.ct{font-size:11px;font-weight:700;color:#8aaccc;text-transform:uppercase;letter-spacing:.05em}
.cb{padding:13px}
.fg{display:grid;grid-template-columns:repeat(auto-fill,minmax(145px,1fr));gap:11px}
.fg2{display:grid;grid-template-columns:1fr 1fr;gap:11px}
.fg3{display:grid;grid-template-columns:1fr 1fr 1fr;gap:11px}
.fl{display:flex;flex-direction:column;gap:4px}
.flb{font-size:11px;color:var(--t2);text-transform:uppercase;letter-spacing:.06em}
.fw{display:flex}
/* NUMBER INPUTS ‚Äî no oninput rerender, just save state */
.fi{flex:1;background:var(--bg);border:1px solid var(--bd);border-radius:7px;color:var(--t);font-size:14px;padding:7px 9px;outline:none;font-family:'Courier New',monospace;width:100%;transition:border-color .2s;-webkit-appearance:none;appearance:none}
.fi.u{border-radius:7px 0 0 7px}
.fi:focus{border-color:var(--c);box-shadow:0 0 0 2px #00dfc020}
.fi::placeholder{color:var(--t3)}
input[type=number]::-webkit-inner-spin-button,input[type=number]::-webkit-outer-spin-button{opacity:.4}
.fu{background:var(--bg3);border:1px solid var(--bd);border-left:none;border-radius:0 7px 7px 0;padding:7px 8px;font-size:11px;color:var(--t3);white-space:nowrap;display:flex;align-items:center}
.fsel{width:100%;background:var(--bg);border:1px solid var(--bd);border-radius:7px;color:var(--t);font-size:13px;padding:7px 9px;outline:none;font-family:inherit;cursor:pointer;transition:border-color .2s}
.fsel:focus{border-color:var(--c)}
.fconv{font-size:10px;color:var(--c);margin-top:3px;line-height:1.5;min-height:16px}
.crit{display:flex;align-items:flex-start;gap:11px;padding:11px 13px;border-radius:8px;border:1px solid var(--bd);background:var(--bg);cursor:pointer;transition:.15s;user-select:none;margin-bottom:9px}
.crit:hover{border-color:var(--bd2)}
.crit.on{background:#10c98a0a;border-color:#10c98a44}
.cbox{width:22px;height:22px;border-radius:5px;border:2px solid var(--bd2);background:transparent;flex-shrink:0;display:flex;align-items:center;justify-content:center;transition:.15s;margin-top:1px}
.crit.on .cbox{background:var(--g);border-color:var(--g)}
.ctit{font-size:14px;font-weight:600;color:var(--t)}
.cdesc{font-size:12px;color:var(--t2);margin-top:3px;line-height:1.5}
.cinp{margin-top:9px}
.ccnt{display:flex;justify-content:center;gap:8px;margin-bottom:13px}
.cdot{width:34px;height:34px;border-radius:50%;border:2px solid var(--bd);display:flex;align-items:center;justify-content:center;font-size:12px;font-weight:700;color:var(--t3);transition:.3s}
.cdot.m{border-color:var(--g);background:#10c98a20;color:var(--g)}
.egrid{display:grid;grid-template-columns:1fr 1fr;gap:7px}
.eb{padding:8px 11px;border-radius:7px;border:1px solid var(--bd);background:var(--bg);color:var(--t2);font-size:12px;cursor:pointer;text-align:left;transition:.15s;font-family:inherit}
.eb:hover{border-color:var(--bd2);color:var(--t)}
.eb.on{background:#00dfc010;border-color:#00dfc066;color:var(--c);font-weight:600}
.esub{font-size:10px;color:var(--t3);margin-top:2px}
.eb.on .esub{color:#00dfc080}
.tg{display:flex;gap:6px;flex-wrap:wrap;margin-top:6px}
.tb{padding:7px 13px;border-radius:6px;border:1px solid var(--bd);background:var(--bg);color:var(--t2);font-size:13px;cursor:pointer;font-family:inherit;transition:.15s}
.tb:hover{border-color:var(--bd2);color:var(--t)}
.tb.on{background:#00dfc012;border-color:#00dfc066;color:var(--c);font-weight:600}
.tb.ong{background:#10c98a18;border-color:#10c98a55;color:var(--g);font-weight:600}
.tb.onr{background:#ef434318;border-color:#ef434355;color:var(--r);font-weight:600}
.btnrow{display:flex;gap:9px;margin-top:18px;padding-bottom:28px}
.btn{padding:12px 18px;border-radius:8px;border:none;font-size:14px;font-weight:600;cursor:pointer;font-family:inherit;transition:.15s;flex:1}
.btn-p{background:var(--c);color:#000}
.btn-p:hover{background:#00c8aa}
.btn-p:disabled{background:var(--bd);color:var(--t3);cursor:not-allowed}
.btn-s{background:var(--bg3);color:var(--t2);border:1px solid var(--bd);flex:0 0 auto;padding:12px 14px}
.btn-s:hover{border-color:var(--bd2);color:var(--t)}
.ib{background:var(--bg3);border:1px solid var(--bd);border-radius:7px;padding:9px 12px;font-size:11px;color:var(--t2);line-height:1.6;margin-top:9px}
.al{padding:9px 13px;border-radius:7px;font-size:12px;line-height:1.6;margin-bottom:11px;border:1px solid}
.al-i{background:#4a9eff18;border-color:#4a9eff44;color:#7ac0ff}
.al-w{background:#f5a62318;border-color:#f5a62355;color:#f5c060}
.al-g{background:#10c98a18;border-color:#10c98a44;color:var(--g)}
.al-r{background:#ef434318;border-color:#ef434355;color:var(--r)}
.sgrid{display:grid;grid-template-columns:repeat(auto-fill,minmax(280px,1fr));gap:12px}
.sc{background:var(--bg2);border-radius:10px;overflow:hidden;border:1px solid var(--bd)}
.sch{padding:10px 13px;border-bottom:1px solid;display:flex;justify-content:space-between;align-items:center}
.scn{font-size:13px;font-weight:700;color:var(--t)}
.scfn{font-size:10px;color:var(--t3);margin-top:1px}
.scv{font-size:26px;font-weight:700;font-family:'Courier New',monospace}
.scb{padding:11px 13px}
.sr{display:flex;justify-content:space-between;align-items:center;padding:4px 0;border-bottom:1px solid #1a2d4422;font-size:12px}
.sr:last-child{border-bottom:none}
.srl{color:var(--t2)}
.srv{font-family:'Courier New',monospace;font-weight:700;color:var(--t)}
.svrd{margin-top:9px;padding:8px 11px;border-radius:7px;border:1px solid}
.svt{font-size:13px;font-weight:700}
.svs{font-size:11px;color:var(--t2);margin-top:2px}
.tpt{display:flex;gap:7px;margin-bottom:14px;flex-wrap:wrap}
.tpb{padding:5px 16px;border-radius:20px;border:1px solid var(--bd);background:var(--bg3);color:var(--t2);font-size:13px;cursor:pointer;font-family:'Courier New',monospace;font-weight:700;transition:.15s}
.tpb.on{background:#00dfc018;border-color:#00dfc066;color:var(--c)}
.ctbl{width:100%;border-collapse:collapse;font-size:13px}
.ctbl th{padding:7px 8px;background:var(--bg3);color:var(--t2);font-size:10px;text-transform:uppercase;letter-spacing:.05em;border-bottom:1px solid var(--bd);text-align:left}
.ctbl td{padding:8px;border-bottom:1px solid #1a2d4422}
.ctbl tr:hover td{background:var(--bg3)}
.tpv{font-family:'Courier New',monospace;font-weight:700;font-size:16px}
.tu{color:var(--r)}.td{color:var(--g)}.tf{color:var(--y)}
.ri{display:flex;align-items:center;gap:9px;padding:9px 13px;cursor:pointer;border-left:3px solid;transition:background .1s;user-select:none}
.ri:hover{background:var(--bg3)}
.ri.dn{opacity:.5}
.ri.dn .rit{text-decoration:line-through}
.ric{width:19px;height:19px;border-radius:4px;border:2px solid var(--bd2);flex-shrink:0;display:flex;align-items:center;justify-content:center;transition:.15s}
.ri.dn .ric{background:var(--g);border-color:var(--g)}
.rit{font-size:13px;color:var(--t);flex:1;line-height:1.4}
.rip{width:7px;height:7px;border-radius:50%;flex-shrink:0}
.ds{display:flex;gap:11px;padding:13px;border-radius:8px;margin-bottom:9px;border:1px solid}
.di{width:32px;height:32px;border-radius:8px;flex-shrink:0;display:flex;align-items:center;justify-content:center;font-size:18px}
.dl{font-size:14px;font-weight:700;margin-bottom:4px}
.dd{font-size:12px;color:var(--t2);line-height:1.6}
.ub{display:inline-block;font-size:10px;font-weight:700;padding:1px 8px;border-radius:10px;background:#ef434322;color:var(--r);border:1px solid #ef434355;margin-left:7px;animation:bk 1.5s infinite}
.sl{font-size:11px;color:var(--t3);text-transform:uppercase;letter-spacing:.07em;margin-bottom:7px}
/* SURGICAL CALC */
.surg-sel{width:100%;background:var(--bg);border:1.5px solid var(--bd);border-radius:8px;color:var(--t);font-size:14px;padding:10px 12px;outline:none;font-family:inherit;cursor:pointer;transition:border-color .2s;margin-top:5px}
.surg-sel:focus{border-color:var(--c);box-shadow:0 0 0 2px #00dfc020}
.surg-item{margin-bottom:14px}
.surg-lbl{font-size:13px;font-weight:600;color:var(--t);margin-bottom:4px}
.surg-sub{font-size:11px;color:var(--t3);margin-bottom:3px}
.score-big{text-align:center;padding:18px;border-radius:10px;border:1px solid;margin-top:14px}
.score-num{font-size:52px;font-weight:700;font-family:'Courier New',monospace}
.score-lbl{font-size:14px;font-weight:700;margin-top:6px}
.score-rec{font-size:13px;margin-top:8px;line-height:1.6;color:var(--t2)}
.fi-anim{animation:fu .2s ease both}
@keyframes fu{from{opacity:0;transform:translateY(5px)}to{opacity:1;transform:translateY(0)}}
@keyframes bk{0%,100%{opacity:1}50%{opacity:.4}}
@media(max-width:480px){
  .fg{grid-template-columns:1fr 1fr}
  .fg3{grid-template-columns:1fr 1fr}
  .sgrid{grid-template-columns:1fr}
  .egrid{grid-template-columns:1fr}
}
::-webkit-scrollbar{width:4px;height:4px}
::-webkit-scrollbar-thumb{background:var(--bd2);border-radius:2px}
</style>
</head>
<body>

<div class="hdr">
  <div class="logo">üî¨</div>
  <div>
    <div class="logo-t">Pancrea-Score</div>
    <div class="logo-s">–û—Å—Ç—Ä—ã–π –ü–∞–Ω–∫—Ä–µ–∞—Ç–∏—Ç ¬∑ –û—Ü–µ–Ω–∫–∞ —Ç—è–∂–µ—Å—Ç–∏</div>
  </div>
  <div id="dbadge" class="dbadge warn">‚ö† 0/3</div>
</div>
<div class="snav" id="snav"></div>
<div class="wrap" id="main"></div>

<script>
// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
// STATE ‚Äî —á–∏—Å–ª–∞ —Ö—Ä–∞–Ω—è—Ç—Å—è –∫–∞–∫ —Å—Ç—Ä–æ–∫–∏, –ø–∞—Ä—Å—è—Ç—Å—è –ø—Ä–∏ —Ä–∞—Å—á—ë—Ç–µ
// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
var ST = {
  step:0, tp:'24h',
  diag:{pain:false,enzymes:false,imaging:false,amylase:'',lipase:'',imgType:''},
  etio:'', onset:'', onsetT:'',
  pat:{age:'',weight:'',chronicYes:false,chronic:'none'},
  data:{'24h':{},'48h':{},'72h':{}},
  rem:{},
  dr:{inf:false,timing:'late',loc:'perigastric',nec:'small',stab:'stable'},
  surg:{gender:'',necrosis:'',character:'',wall:'',crp:'',failure:'',volume:''}
};

var DDEF={
  temp:'',hr:'',rr:'',sbp:'',dbp:'',uo:'',gcs:'15',men:'normal',vaso:'none',
  sirs_type:'none',
  urea:'',na:'',k:'',creat:'',bili:'',wbc:'',hct:'',plt:'',alb:'',tp:'',crp:'',
  gluc:'',hb:'',ldh:'',ast:'',ca:'',basedef:'',fluidseq:'',
  ph:'',pao2:'',fio2:'0.21',
  ctg:'0',nec:'none',ext:'no',ple:'no',arf:'no',
  dzh_peritoneal:'no',dzh_enceph:'no',dzh_ecg:'no',dzh_exudate:'no',
  dzh_parapanc:'no',dzh_steatonec:'no',dzh_nofluid:'no'
};

function D(tp){ if(!ST.data[tp]||ST.data[tp].temp===undefined){ST.data[tp]=JSON.parse(JSON.stringify(DDEF));} return ST.data[tp]; }

// –ü–∞—Ä—Å–∏–Ω–≥ —á–∏—Å–ª–∞ ‚Äî –∑–∞–º–µ–Ω—è–µ–º –∑–∞–ø—è—Ç—É—é –Ω–∞ —Ç–æ—á–∫—É
function pf(v){ if(v===null||v===undefined||v==='')return null; var n=parseFloat(String(v).replace(',','.')); return isNaN(n)?null:n; }

// –°–æ—Ö—Ä–∞–Ω–∏—Ç—å –ø–æ–ª–µ –¥–∞–Ω–Ω—ã—Ö ‚Äî –ù–ï –≤—ã–∑—ã–≤–∞–µ—Ç R() (—á—Ç–æ–±—ã –Ω–µ —Ç–µ—Ä—è—Ç—å —Ñ–æ–∫—É—Å)
function sD(tp,k,v){ D(tp)[k]=String(v).replace(',','.'); }
// –°–æ—Ö—Ä–∞–Ω–∏—Ç—å –∏ –ø–µ—Ä–µ—Ä–∏—Å–æ–≤–∞—Ç—å (–¥–ª—è select)
function sDR(tp,k,v){ D(tp)[k]=v; R(); }
// –ü–∞—Ü–∏–µ–Ω—Ç
function sP(k,v){ ST.pat[k]=v; }
function sPR(k,v){ ST.pat[k]=v; R(); }
// –ü–æ—Å–ª–µ –ø–æ—Ç–µ—Ä–∏ —Ñ–æ–∫—É—Å–∞ ‚Äî –ø–æ–ª–Ω–∞—è –ø–µ—Ä–µ—Ä–∏—Å–æ–≤–∫–∞
function onBlur(){ R(); }

// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
// –ö–û–ù–í–ï–†–¢–ê–¶–ò–ò (–µ–¥–∏–Ω–∏—Ü—ã –°–ò)
// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
function urea2bun(v){ return v*2.8; }       // –º–º–æ–ª—å/–ª ‚Üí –º–≥/–¥–ª
function cr2mgdl(v){ return v/88.4; }       // –º–∫–º–æ–ª—å/–ª ‚Üí –º–≥/–¥–ª
function bi2mgdl(v){ return v/17.1; }       // –º–∫–º–æ–ª—å/–ª ‚Üí –º–≥/–¥–ª
// Na, K –º–º–æ–ª—å/–ª = mEq/L –Ω–∞–ø—Ä—è–º—É—é

// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
// –†–ê–°–ß–Å–¢ –®–ö–ê–õ
// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
function calc(tp){
  var d=D(tp), age=pf(ST.pat.age)||0;
  var temp=pf(d.temp),hr=pf(d.hr),rr=pf(d.rr);
  var sbp=pf(d.sbp),dbp=pf(d.dbp);
  var map=(sbp&&dbp)?((sbp+2*dbp)/3|0):null;
  var ph=pf(d.ph),pao2=pf(d.pao2),fio2=pf(d.fio2)||0.21;
  var na=pf(d.na),k=pf(d.k);
  var urea=pf(d.urea), bun=urea?urea2bun(urea):null;
  var creat=pf(d.creat), cr=creat?cr2mgdl(creat):null;
  var bili=pf(d.bili), bi=bili?bi2mgdl(bili):null;
  var hct=pf(d.hct),wbc=pf(d.wbc),plt=pf(d.plt);
  var gcs=pf(d.gcs)||15;
  var alb=pf(d.alb),tp2=pf(d.tp),crp=pf(d.crp);
  var uo=pf(d.uo);

  // ‚îÄ‚îÄ APACHE II APS ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
  var aps=0;
  if(temp!==null){
    if(temp>=41)aps+=4;else if(temp>=39)aps+=3;else if(temp>=38.5)aps+=1;
    else if(temp<36&&temp>=34)aps+=1;else if(temp<34&&temp>=32)aps+=2;
    else if(temp<32&&temp>=30)aps+=3;else if(temp<30)aps+=4;
  }
  if(map!==null){
    if(map>=160)aps+=4;else if(map>=130)aps+=3;else if(map>=110)aps+=2;
    else if(map<70&&map>=50)aps+=2;else if(map<50)aps+=4;
  }
  if(hr!==null){
    if(hr>=180)aps+=4;else if(hr>=140)aps+=3;else if(hr>=110)aps+=2;
    else if(hr<55&&hr>=40)aps+=2;else if(hr<40)aps+=4;
  }
  if(rr!==null){
    if(rr>=50)aps+=4;else if(rr>=35)aps+=3;else if(rr>=25)aps+=1;
    else if(rr<10&&rr>=6)aps+=2;else if(rr<6)aps+=4;
  }
  if(pao2){
    if(fio2>=0.5){var aa=Math.max(0,713*fio2-pao2);if(aa>=500)aps+=4;else if(aa>=350)aps+=3;else if(aa>=200)aps+=2;}
    else{if(pao2>70)aps+=0;else if(pao2>=61)aps+=1;else if(pao2>=55)aps+=3;else aps+=4;}
  }
  if(ph!==null){
    if(ph>=7.7)aps+=4;else if(ph>=7.6)aps+=3;else if(ph>=7.5)aps+=1;
    else if(ph<7.33&&ph>=7.25)aps+=2;else if(ph<7.25&&ph>=7.15)aps+=3;else if(ph<7.15)aps+=4;
  }
  if(na!==null){
    if(na>=180)aps+=4;else if(na>=160)aps+=3;else if(na>=155)aps+=2;else if(na>=150)aps+=1;
    else if(na<130&&na>=120)aps+=2;else if(na<120&&na>=111)aps+=3;else if(na<111)aps+=4;
  }
  if(k!==null){
    if(k>=7)aps+=4;else if(k>=6)aps+=3;else if(k>=5.5)aps+=1;
    else if(k<3&&k>=2.5)aps+=2;else if(k<2.5)aps+=4;
  }
  if(cr!==null){
    var cs=0;
    if(cr>=3.5)cs=4;else if(cr>=2)cs=3;else if(cr>=1.5)cs=2;else if(cr<0.6)cs=2;
    if(d.arf==='yes')cs=Math.min(cs*2,8);
    aps+=cs;
  }
  if(hct!==null){
    if(hct>=60)aps+=4;else if(hct>=50)aps+=2;else if(hct>=46)aps+=1;
    else if(hct<30&&hct>=20)aps+=2;else if(hct<20)aps+=4;
  }
  if(wbc!==null){
    if(wbc>=40)aps+=4;else if(wbc>=20)aps+=2;else if(wbc>=15)aps+=1;
    else if(wbc<3&&wbc>=1)aps+=2;else if(wbc<1)aps+=4;
  }
  aps+=Math.max(0,15-gcs);

  var ageS=age>=75?6:age>=65?5:age>=55?3:age>=45?2:0;
  var chrS=ST.pat.chronic==='nonop'?5:ST.pat.chronic==='elective'?2:0;
  var apache=aps+ageS+chrS;

  // ‚îÄ‚îÄ BISAP ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
  var bisap=0,sirs=0;
  if(bun!==null&&bun>25)bisap++;
  if(d.men==='impaired')bisap++;
  if(temp!==null&&(temp>38||temp<36))sirs++;
  if(hr!==null&&hr>90)sirs++;
  if(rr!==null&&rr>20)sirs++;
  if(wbc!==null&&(wbc>12||wbc<4))sirs++;
  if(sirs>=2)bisap++;
  if(age>60)bisap++;
  if(d.ple==='yes')bisap++;

  // ‚îÄ‚îÄ SOFA ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
  var resp=0,coag=0,liver=0,cardio=0,cns=0,renal=0;
  if(pao2&&fio2>0){var pf2=pao2/fio2;if(pf2<100)resp=4;else if(pf2<200)resp=3;else if(pf2<300)resp=2;else if(pf2<400)resp=1;}
  if(plt!==null){if(plt<20)coag=4;else if(plt<50)coag=3;else if(plt<100)coag=2;else if(plt<150)coag=1;}
  if(bi!==null){if(bi>=12)liver=4;else if(bi>=6)liver=3;else if(bi>=2)liver=2;else if(bi>=1.2)liver=1;}
  if(d.vaso==='dopa_high'||d.vaso==='epi')cardio=4;
  else if(d.vaso==='dopa_mid')cardio=3;
  else if(d.vaso==='dopa_low')cardio=2;
  else if(map!==null&&map<70)cardio=1;
  var gcsd=Math.max(0,15-gcs);
  cns=gcsd>=10?4:gcsd>=7?3:gcsd>=4?2:gcsd>=2?1:0;
  if(creat!==null){
    if(creat>=309||(uo!==null&&uo<200))renal=4;
    else if(creat>=221||(uo!==null&&uo<500))renal=3;
    else if(creat>=177)renal=2;else if(creat>=106)renal=1;
  }
  var sofa=resp+coag+liver+cardio+cns+renal;

  // ‚îÄ‚îÄ mCTSI ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
  var ctg=parseInt(d.ctg)||0;
  var nmap={none:0,lt30:2,'30to50':4,gt50:6};
  var mctsi=ctg+(nmap[d.nec]||0)+(d.ext==='yes'?2:0);

  // ‚îÄ‚îÄ NAPP ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
  var napp=(alb!==null&&tp2!==null)?(tp2-alb):null;

  // –¶–≤–µ—Ç–∞
  var apC=apache>=20?'var(--r)':apache>=8?'var(--y)':'var(--g)';
  var biC=bisap>=3?'var(--r)':bisap>=2?'var(--y)':'var(--g)';
  var soC=sofa>=7?'var(--r)':sofa>=4?'var(--y)':'var(--g)';
  var mcC=mctsi>=7?'var(--r)':mctsi>=4?'var(--y)':'var(--g)';

  return {apache,aps,ageS,chrS,apC,
    apMort:apache>=35?'>85%':apache>=25?'~55%':apache>=20?'~40%':apache>=15?'~25%':apache>=10?'~15%':'<10%',
    bisap,sirs,biC,
    biMort:bisap===0?'<1%':bisap===1?'<1%':bisap===2?'3.6%':bisap===3?'5.3%':bisap===4?'12.7%':'22.5%',
    sofa,resp,coag,liver,cardio,cns,renal,soC,
    mctsi,ctg,mcC,
    napp:napp!==null?napp.toFixed(1):null,
    crp,crpC:crp?(tp!=='24h'?(crp>=150?'var(--r)':crp>=100?'var(--y)':'var(--g)'):(crp>100?'var(--y)':'var(--g)')):'var(--t3)',
    map,bun,cr,bi,urea,creat,bili,na,k,wbc,gcs,ph,pao2,fio2};
}

// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
// RANSON SCORE
// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
function calcRanson(){
  var d24=D('24h'), d48=D('48h');
  var age=pf(ST.pat.age)||0;
  var pts=[];

  // –ü—Ä–∏ –ø–æ—Å—Ç—É–ø–ª–µ–Ω–∏–∏ (24—á)
  var r1=age>55; pts.push({lbl:'–í–æ–∑—Ä–∞—Å—Ç >55 –ª–µ—Ç',val:r1});
  var wbc24=pf(d24.wbc); var r2=wbc24!==null&&wbc24>16; pts.push({lbl:'–õ–µ–π–∫–æ—Ü–∏—Ç—ã >16√ó10‚Åπ/–ª',val:r2});
  var gluc24=pf(d24.gluc); var r3=gluc24!==null&&gluc24>11.1; pts.push({lbl:'–ì–ª—é–∫–æ–∑–∞ >11.1 –º–º–æ–ª—å/–ª',val:r3});
  var ldh24=pf(d24.ldh); var r4=ldh24!==null&&ldh24>350; pts.push({lbl:'–õ–î–ì >350 –ú–ï/–ª',val:r4});
  var ast24=pf(d24.ast); var r5=ast24!==null&&ast24>250; pts.push({lbl:'–ê–°–¢ >250 –ú–ï/–ª',val:r5});

  // –ß–µ—Ä–µ–∑ 48 —á–∞—Å–æ–≤
  var hct24=pf(d24.hct), hct48=pf(d48.hct);
  var r6=(hct24!==null&&hct48!==null)?(hct24-hct48>10):false;
  pts.push({lbl:'–°–Ω–∏–∂–µ–Ω–∏–µ Ht >10% –∑–∞ 48—á',val:r6,note:'48—á'});

  var urea24=pf(d24.urea), urea48=pf(d48.urea);
  var r7=(urea24!==null&&urea48!==null)?(urea48-urea24>1.8):false;
  pts.push({lbl:'–†–æ—Å—Ç –º–æ—á–µ–≤–∏–Ω—ã >1.8 –º–º–æ–ª—å/–ª –∑–∞ 48—á',val:r7,note:'48—á'});

  var ca48=pf(d48.ca); var r8=ca48!==null&&ca48<2.0; pts.push({lbl:'Ca <2.0 –º–º–æ–ª—å/–ª (48—á)',val:r8,note:'48—á'});
  var pao248=pf(d48.pao2); var r9=pao248!==null&&pao248<60; pts.push({lbl:'PaO‚ÇÇ <60 –º–º —Ä—Ç.—Å—Ç. (48—á)',val:r9,note:'48—á'});
  var bd48=pf(d48.basedef); var r10=bd48!==null&&bd48>4; pts.push({lbl:'–î–µ—Ñ–∏—Ü–∏—Ç –æ—Å–Ω–æ–≤–∞–Ω–∏–π >4 –º—ç–∫–≤/–ª (48—á)',val:r10,note:'48—á'});
  var fs48=pf(d48.fluidseq); var r11=fs48!==null&&fs48>6; pts.push({lbl:'–°–µ–∫–≤–µ—Å—Ç—Ä–∞—Ü–∏—è –∂–∏–¥–∫–æ—Å—Ç–∏ >6 –ª (48—á)',val:r11,note:'48—á'});

  var score=pts.filter(function(p){return p.val;}).length;
  var mort=score<=2?'<1%':score<=4?'~15%':score<=6?'~40%':'>50%';
  var sev=score<=2?'g':score<=4?'y':'r';
  var sevLbl=score<=2?'–õ—ë–≥–∫–∏–π':score<=4?'–°—Ä–µ–¥–Ω–µ–π —Ç—è–∂–µ—Å—Ç–∏':score<=6?'–¢—è–∂—ë–ª—ã–π':'–ö—Ä–∞–π–Ω–µ —Ç—è–∂—ë–ª—ã–π';
  return {score,pts,mort,sev,sevLbl};
}

// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
// –®–ö–ê–õ–ê –î–ñ–ê–ù–ï–õ–ò–î–ó–ï
// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
function calcDzhanelidge(tp){
  var d=D(tp);
  var crit=[];
  var sbp=pf(d.sbp), uo=pf(d.uo), wbc=pf(d.wbc), gluc=pf(d.gluc), urea=pf(d.urea), hb=pf(d.hb);

  crit.push({lbl:'–ü–µ—Ä–∏—Ç–æ–Ω–µ–∞–ª—å–Ω—ã–µ —Å–∏–º–ø—Ç–æ–º—ã',       auto:false, val:d.dzh_peritoneal==='yes'});
  crit.push({lbl:'–û–ª–∏–≥—É—Ä–∏—è <250 –º–ª/12—á',          auto:true,  val:uo!==null&&uo<500, hint:uo?uo+' –º–ª/—Å—É—Ç':'–Ω–µ—Ç –¥–∞–Ω–Ω—ã—Ö'});
  crit.push({lbl:'–ê–î —Å–∏—Å—Ç. <100 –º–º —Ä—Ç.—Å—Ç.',       auto:true,  val:sbp!==null&&sbp<100, hint:sbp?sbp+' –º–º —Ä—Ç.—Å—Ç.':'–Ω–µ—Ç –¥–∞–Ω–Ω—ã—Ö'});
  crit.push({lbl:'–≠–Ω—Ü–µ—Ñ–∞–ª–æ–ø–∞—Ç–∏—è',                 auto:false, val:d.dzh_enceph==='yes'});
  crit.push({lbl:'Hb >160 –≥/–ª',                   auto:true,  val:hb!==null&&hb>160, hint:hb?hb+' –≥/–ª':'–Ω–µ—Ç –¥–∞–Ω–Ω—ã—Ö'});
  crit.push({lbl:'–õ–µ–π–∫–æ—Ü–∏—Ç—ã >14 000/–º–∫–ª',         auto:true,  val:wbc!==null&&wbc>14, hint:wbc?wbc+'√ó10‚Åπ/–ª':'–Ω–µ—Ç –¥–∞–Ω–Ω—ã—Ö'});
  crit.push({lbl:'–ì–ª—é–∫–æ–∑–∞ >10 –º–º–æ–ª—å/–ª',           auto:true,  val:gluc!==null&&gluc>10, hint:gluc?gluc+' –º–º–æ–ª—å/–ª':'–Ω–µ—Ç –¥–∞–Ω–Ω—ã—Ö'});
  crit.push({lbl:'–ú–æ—á–µ–≤–∏–Ω–∞ >12 –º–º–æ–ª—å/–ª',          auto:true,  val:urea!==null&&urea>12, hint:urea?urea+' –º–º–æ–ª—å/–ª':'–Ω–µ—Ç –¥–∞–Ω–Ω—ã—Ö'});
  crit.push({lbl:'–ú–µ—Ç–∞–±–æ–ª–∏—á. –∏–∑–º–µ–Ω–µ–Ω–∏—è –Ω–∞ –≠–ö–ì',   auto:false, val:d.dzh_ecg==='yes'});
  crit.push({lbl:'–í–∏—à–Ω—ë–≤—ã–π/—á—ë—Ä–Ω—ã–π —ç–∫—Å—Å—É–¥–∞—Ç (–ª–∞–ø–∞—Ä–æ—Å–∫–æ–ø–∏—è)',auto:false,val:d.dzh_exudate==='yes'});
  crit.push({lbl:'–†–∞—Å–ø—Ä–æ—Å—Ç—Ä–∞–Ω—ë–Ω–Ω—ã–π –ø–∞—Ä–∞–ø–∞–Ω–∫—Ä–µ–∞—Ç–∏—Ç (–≤—ã—Ö–æ–¥–∏—Ç –∏–∑ —Å–∞–ª—å–Ω–∏–∫–æ–≤–æ–π —Å—É–º–∫–∏)',auto:false,val:d.dzh_parapanc==='yes'});
  crit.push({lbl:'–°—Ç–µ–∞—Ç–æ–Ω–µ–∫—Ä–æ–∑—ã',                  auto:false, val:d.dzh_steatonec==='yes'});
  crit.push({lbl:'–ù–µ—Ç —ç—Ñ—Ñ–µ–∫—Ç–∞ –æ—Ç –∏–Ω—Ñ—É–∑–∏–æ–Ω–Ω–æ–π —Ç–µ—Ä–∞–ø–∏–∏',auto:false,val:d.dzh_nofluid==='yes'});

  var score=crit.filter(function(c){return c.val;}).length;
  var sev=score>=5?'r':score>=2?'y':'g';
  var sevLbl=score>=5?'–¢—è–∂—ë–ª—ã–π':score>=2?'–°—Ä–µ–¥–Ω–µ–π —Ç—è–∂–µ—Å—Ç–∏':'–õ—ë–≥–∫–∏–π';
  return {score,crit,sev,sevLbl};
}


var STEPS=[
  {id:'diag',   lbl:'–î–∏–∞–≥–Ω–æ–∑',    ico:'ü©ª'},
  {id:'pat',    lbl:'–ü–∞—Ü–∏–µ–Ω—Ç',    ico:'üë§'},
  {id:'vitals', lbl:'–í–∏—Ç–∞–ª—å–Ω—ã–µ',  ico:'ü´Ä'},
  {id:'labs',   lbl:'–ê–Ω–∞–ª–∏–∑—ã',    ico:'üß™'},
  {id:'gas',    lbl:'–ö–©–°/–ö–¢',    ico:'üå¨Ô∏è'},
  {id:'scores', lbl:'–†–µ–∑—É–ª—å—Ç–∞—Ç—ã', ico:'üìä'},
  {id:'dyn',    lbl:'–î–∏–Ω–∞–º–∏–∫–∞',   ico:'üìà'},
  {id:'rem',    lbl:'–ù–∞–ø–æ–º–∏–Ω–∞–Ω–∏—è',ico:'üîî'},
  {id:'drain',  lbl:'–î—Ä–µ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ',ico:'ü©∫'},
  {id:'surg',   lbl:'–û–±—ä—ë–º –≤–º–µ—à.',ico:'üè•'}
];

function confirmed(){ return (ST.diag.pain?1:0)+(ST.diag.enzymes?1:0)+(ST.diag.imaging?1:0)>=2; }
function critCnt(){ return (ST.diag.pain?1:0)+(ST.diag.enzymes?1:0)+(ST.diag.imaging?1:0); }

// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
// RENDER CONTROLLER
// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
function R(){
  // –û–±–Ω–æ–≤–ª—è–µ–º —Ç–æ–ª—å–∫–æ badge –∏ nav ‚Äî –±–µ–∑ –ø–æ—Ç–µ—Ä–∏ —Ñ–æ–∫—É—Å–∞ –µ—Å–ª–∏ —É–∂–µ –≤ –∫–æ–Ω—Ç–µ–Ω—Ç–µ
  var cnt=critCnt(),ok=confirmed();
  var b=document.getElementById('dbadge');
  b.className='dbadge '+(ok?'ok':'warn');
  b.textContent=ok?'‚úÖ –û–ü –ø–æ–¥—Ç–≤–µ—Ä–∂–¥—ë–Ω ('+cnt+'/3)':'‚ö† –î–∏–∞–≥–Ω–æ–∑: '+cnt+'/3';

  // Nav
  var nav=document.getElementById('snav');
  nav.innerHTML=STEPS.map(function(s,i){
    var locked=i>0&&!ok;
    var cls='sb'+(ST.step===i?' active':'')+(i<ST.step&&!locked?' done':'')+(locked?' locked':'');
    var dot=i<ST.step&&!locked?'‚úì':(i+1);
    return '<button class="'+cls+'" onclick="goto('+i+')"'+(locked?' disabled':'')+'>'+
      '<span class="snum">'+dot+'</span>'+s.ico+' '+s.lbl+'</button>';
  }).join('');

  // Content ‚Äî —Ç–æ–ª—å–∫–æ –µ—Å–ª–∏ –Ω–µ—Ç –∞–∫—Ç–∏–≤–Ω–æ–≥–æ input –≤ —Ñ–æ–∫—É—Å–µ
  var focused=document.activeElement;
  var inInput=focused&&(focused.tagName==='INPUT'||focused.tagName==='SELECT')&&focused.closest('#main');
  if(!inInput){
    renderContent();
  } else {
    // –û–±–Ω–æ–≤–ª—è–µ–º —Ç–æ–ª—å–∫–æ hint-spans –±–µ–∑ –ø–µ—Ä–µ—Ä–∏—Å–æ–≤–∫–∏ –≤—Å–µ–≥–æ
    updateHints();
  }
}

function renderContent(){
  var m=document.getElementById('main');
  var id=STEPS[ST.step].id;
  var html='';
  if(id==='diag')html=pageDiag();
  else if(id==='pat')html=pagePat();
  else if(id==='vitals')html=pageVitals();
  else if(id==='labs')html=pageLabs();
  else if(id==='gas')html=pageGas();
  else if(id==='scores')html=pageScores();
  else if(id==='dyn')html=pageDyn();
  else if(id==='rem')html=pageRem();
  else if(id==='drain')html=pageDrain();
  else if(id==='surg')html=pageSurg();
  m.innerHTML=html;
}

// –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ hint-spans –±–µ–∑ –ø–æ—Ç–µ—Ä–∏ —Ñ–æ–∫—É—Å–∞
function updateHints(){
  var tp=ST.tp,d=D(tp);
  var urea=pf(d.urea),creat=pf(d.creat),bili=pf(d.bili);
  var na=pf(d.na),k=pf(d.k),alb=pf(d.alb),tp2=pf(d.tp),crp=pf(d.crp);
  var sbp=pf(d.sbp),dbp=pf(d.dbp);
  var pao2=pf(d.pao2),fio2=pf(d.fio2)||0.21;

  function upd(id,html){ var el=document.getElementById(id); if(el)el.innerHTML=html; }

  if(sbp&&dbp){upd('hint_map','MAP = ('+d.sbp+' + 2√ó'+d.dbp+') / 3 = <b style="color:var(--c)">'+(((sbp+2*dbp)/3)|0)+' –º–º —Ä—Ç.—Å—Ç.</b>');}
  if(urea){ var bun=urea2bun(urea); upd('hint_urea',urea.toFixed(1)+' –º–º–æ–ª—å/–ª = BUN '+bun.toFixed(1)+' –º–≥/–¥–ª'+(urea>8.93?' <b style="color:var(--r)">‚ö† BISAP >25 –º–≥/–¥–ª</b>':'')); }
  if(creat){ var cr=cr2mgdl(creat); upd('hint_creat',creat+' –º–∫–º–æ–ª—å/–ª = '+cr.toFixed(2)+' –º–≥/–¥–ª'+(creat>=309?' <b style="color:var(--r)">SOFA 4</b>':creat>=221?' <b style="color:var(--y)">SOFA 3</b>':creat>=177?' SOFA 2':creat>=106?' SOFA 1':'')); }
  if(bili){ var bi=bi2mgdl(bili); upd('hint_bili',bili+' –º–∫–º–æ–ª—å/–ª = '+bi.toFixed(2)+' –º–≥/–¥–ª'+(bili>=205?' <b style="color:var(--r)">SOFA 4</b>':bili>=102?' <b style="color:var(--y)">SOFA 3</b>':bili>=34?' SOFA 2':bili>=20?' SOFA 1':'')); }
  if(na){ upd('hint_na','Na: '+(na<130?'‚ö† –ì–∏–ø–æ–Ω–∞—Ç—Ä–∏–µ–º–∏—è':na>150?'‚ö† –ì–∏–ø–µ—Ä–Ω–∞—Ç—Ä–∏–µ–º–∏—è':'–í –Ω–æ—Ä–º–µ (130‚Äì150)')); }
  if(k){ upd('hint_k','K: '+(k<3.5?'‚ö† –ì–∏–ø–æ–∫–∞–ª–∏–µ–º–∏—è':k>5.5?'‚ö† –ì–∏–ø–µ—Ä–∫–∞–ª–∏–µ–º–∏—è':'–í –Ω–æ—Ä–º–µ (3.5‚Äì5.5)')); }
  if(alb&&tp2){ var n=tp2-alb; upd('hint_napp','NAPP = '+tp2+' ‚àí '+alb+' = <b style="color:'+(n>30?'var(--r)':'var(--g)')+'">'+n.toFixed(1)+' –≥/–ª</b>'+(n>30?' ‚ö† >30 –≥/–ª ‚Äî —Ä–∏—Å–∫ —Ç—è–∂—ë–ª–æ–≥–æ':'  ‚úÖ –Ω–æ—Ä–º–∞')); }
  if(crp){ upd('hint_crp','C–†–ë '+crp+' –º–≥/–ª ‚Üí '+(tp==='24h'?'–ü–∏–∫ –æ–∂–∏–¥–∞–µ—Ç—Å—è –∫ 48—á':crp>=150?'<b style="color:var(--r)">‚â•150 –º–≥/–ª = —Ç—è–∂—ë–ª—ã–π –û–ü</b>':crp>=100?'<b style="color:var(--y)">100‚Äì149 ‚Äî —É–º–µ—Ä–µ–Ω–Ω—ã–π —Ä–∏—Å–∫</b>':'<100 –º–≥/–ª ‚Äî –ª—ë–≥–∫–æ–µ —Ç–µ—á–µ–Ω–∏–µ')); }
  if(pao2&&fio2){ var pf3=Math.round(pao2/fio2); upd('hint_pf','PaO‚ÇÇ/FiO‚ÇÇ = <b style="color:var(--c)">'+pf3+'</b> ‚Üí '+(pf3<100?'<b style="color:var(--r)">–¢—è–∂. –î–ù (SOFA 4)</b>':pf3<200?'<b style="color:var(--r)">–î–ù (SOFA 3)</b>':pf3<300?'<b style="color:var(--y)">–£–º–µ—Ä. (SOFA 2)</b>':pf3<400?'–õ—ë–≥–∫–∞—è (SOFA 1)':'–ù–æ—Ä–º–∞ (0)')); }
  
  // pH hint
  var ph=pf(d.ph);
  if(ph){ upd('hint_ph','pH '+ph.toFixed(2)+' ‚Üí '+(ph>=7.7?'<b style="color:var(--r)">APACHE +4</b>':ph>=7.6?'<b style="color:var(--r)">APACHE +3</b>':ph>=7.5?'<b style="color:var(--y)">APACHE +1</b>':ph>=7.33?'<span style="color:var(--g)">–ù–æ—Ä–º–∞ (0)</span>':ph>=7.25?'<b style="color:var(--y)">APACHE +2</b>':ph>=7.15?'<b style="color:var(--r)">APACHE +3</b>':'<b style="color:var(--r)">APACHE +4</b>')); }
}

function goto(i){ if(i>0&&!confirmed())return; ST.step=i; renderContent(); window.scrollTo(0,0); }
function next(){ goto(ST.step+1); }
function back(){ if(ST.step>0)goto(ST.step-1); }

// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
// –°–¢–†–ê–ù–ò–¶–´
// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê

// ‚îÄ‚îÄ –î–ò–ê–ì–ù–û–ó ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
function pageDiag(){
  var d=ST.diag,cnt=critCnt(),ok=confirmed();
  function dot(n,m){ return '<div class="cdot'+(m?' m':'')+'">'+( m?'‚úì':n)+'</div>'; }
  return '<div class="fi-anim">'+
  '<div class="card">'+
    '<div class="ch"><span>ü©ª</span><span class="ct">–ü–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ –¥–∏–∞–≥–Ω–æ–∑–∞ –û–ü ‚Äî –∫—Ä–∏—Ç–µ—Ä–∏–∏ Atlanta 2012</span></div>'+
    '<div class="cb">'+
      '<div class="al al-i">üìã –î–∏–∞–≥–Ω–æ–∑ –û–ü –ø—Ä–∏ <b>‚â•2 –∏–∑ 3 –∫—Ä–∏—Ç–µ—Ä–∏–µ–≤</b>. –û—Ç–º–µ—Ç—å—Ç–µ –≥–∞–ª–æ—á–∫–æ–π.</div>'+
      '<div class="ccnt">'+dot(1,d.pain)+dot(2,d.enzymes)+dot(3,d.imaging)+'</div>'+
      '<div style="text-align:center;font-size:13px;color:'+(ok?'var(--g)':'var(--t2)')+';margin-bottom:14px;font-weight:600">'+
        (ok?'‚úÖ –î–∏–∞–≥–Ω–æ–∑ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥—ë–Ω':cnt+'/3 ‚Äî –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ ‚â•2')+
      '</div>'+

      // –ö—Ä–∏—Ç–µ—Ä–∏–π 1
      '<div class="crit'+(d.pain?' on':'')+'" onclick="ST.diag.pain=!ST.diag.pain;R()">'+
        '<div class="cbox">'+(d.pain?'<span style="font-size:13px;color:#000">‚úì</span>':'')+'</div>'+
        '<div><div class="ctit">‚ö° 1. –•–∞—Ä–∞–∫—Ç–µ—Ä–Ω—ã–π –±–æ–ª–µ–≤–æ–π —Å–∏–Ω–¥—Ä–æ–º</div>'+
        '<div class="cdesc">–û—Å—Ç—Ä–∞—è –±–æ–ª—å –≤ —ç–ø–∏–≥–∞—Å—Ç—Ä–∏–∏ / –æ–ø–æ—è—Å—ã–≤–∞—é—â–∞—è ¬∑ –ø–æ—Å—Ç–æ—è–Ω–Ω–∞—è –∏–ª–∏ –Ω–∞—Ä–∞—Å—Ç–∞—é—â–∞—è ¬∑ –∏—Ä—Ä–∞–¥–∏–∞—Ü–∏—è –≤ —Å–ø–∏–Ω—É</div></div>'+
      '</div>'+

      // –ö—Ä–∏—Ç–µ—Ä–∏–π 2 ‚Äî –§–µ—Ä–º–µ–Ω—Ç—ã
      '<div class="crit'+(d.enzymes?' on':'')+'" onclick="ST.diag.enzymes=!ST.diag.enzymes;R()">'+
        '<div class="cbox">'+(d.enzymes?'<span style="font-size:13px;color:#000">‚úì</span>':'')+'</div>'+
        '<div style="flex:1"><div class="ctit">üß™ 2. –§–µ—Ä–º–µ–Ω—Ç—ã –∫—Ä–æ–≤–∏ ‚â•3√ó –í–ì–ù</div>'+
        '<div class="cdesc">–ê–º–∏–ª–∞–∑–∞ ‚â•300 –ï–¥/–ª (–í–ì–ù ~100) &nbsp;–∏–ª–∏&nbsp; –õ–∏–ø–∞–∑–∞ ‚â•180 –ï–¥/–ª (–í–ì–ù ~60)</div>'+
        '<div class="cinp" onclick="event.stopPropagation()">'+
          '<div class="fg2" style="margin-top:8px">'+
            inpUnit('–ê–º–∏–ª–∞–∑–∞','text','diag_amylase',d.amylase||'','–ï–¥/–ª',
              'ST.diag.amylase=this.value;checkEnz()',
              'checkEnz();R()',
              pf(d.amylase)?( pf(d.amylase)>=300?'‚úÖ ‚â•300 –µ–¥/–ª (‚â•3√ó–í–ì–ù)':'‚Ñπ '+(pf(d.amylase)/100).toFixed(1)+'√ó–í–ì–ù'):'')+
            inpUnit('–õ–∏–ø–∞–∑–∞','text','diag_lipase',d.lipase||'','–ï–¥/–ª',
              'ST.diag.lipase=this.value;checkEnz()',
              'checkEnz();R()',
              pf(d.lipase)?( pf(d.lipase)>=180?'‚úÖ ‚â•180 –µ–¥/–ª (‚â•3√ó–í–ì–ù)':'‚Ñπ '+(pf(d.lipase)/60).toFixed(1)+'√ó–í–ì–ù'):'')+
          '</div>'+
        '</div>'+
        '</div>'+
      '</div>'+

      // –ö—Ä–∏—Ç–µ—Ä–∏–π 3 ‚Äî –í–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è
      '<div class="crit'+(d.imaging?' on':'')+'" onclick="ST.diag.imaging=!ST.diag.imaging;R()">'+
        '<div class="cbox">'+(d.imaging?'<span style="font-size:13px;color:#000">‚úì</span>':'')+'</div>'+
        '<div style="flex:1"><div class="ctit">üñ•Ô∏è 3. –í–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è ‚Äî –ø—Ä–∏–∑–Ω–∞–∫–∏ –û–ü</div>'+
        '<div class="cdesc">–ö–¢ —Å –∫–æ–Ω—Ç—Ä–∞—Å—Ç–æ–º / –ú–†–¢ / –£–ó–ò: –æ—Ç—ë–∫ –ü–ñ, –ø–µ—Ä–∏–ø–∞–Ω–∫—Ä–µ–∞—Ç–∏—á–µ—Å–∫–∞—è –∏–Ω—Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏—è, –Ω–µ–∫—Ä–æ–∑</div>'+
        '<div class="cinp" onclick="event.stopPropagation()">'+
          '<div class="tg">'+
            ['ct:–ö–¢ —Å –∫–æ–Ω—Ç.','mri:–ú–†–¢','us:–£–ó–ò','none:–ù–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–æ'].map(function(x){
              var v=x.split(':')[0],l=x.split(':')[1];
              return '<button class="tb'+(d.imgType===v?' on':'')+'" onclick="ST.diag.imgType=\''+v+'\';if(\''+v+'\'!==\'none\'){ST.diag.imaging=true;}else{ST.diag.imaging=false;}R()">'+l+'</button>';
            }).join('')+
          '</div>'+
        '</div>'+
        '</div>'+
      '</div>'+

      // –≠—Ç–∏–æ–ª–æ–≥–∏—è
      '<div style="margin-top:16px"><div class="sl">–≠—Ç–∏–æ–ª–æ–≥–∏—è (–ø—Ä–µ–¥–ø–æ–ª–∞–≥–∞–µ–º–∞—è)</div>'+
        '<div class="egrid">'+
          [['biliary','ü™® –ñ–ö–ë / —Ö–æ–ª–µ–¥–æ—Ö–æ–ª–∏—Ç–∏–∞–∑','–ñ–µ–ª—á–Ω–æ–∫–∞–º–µ–Ω–Ω–∞—è –±–æ–ª–µ–∑–Ω—å'],
           ['alcohol','üç∑ –ê–ª–∫–æ–≥–æ–ª—å–Ω—ã–π','–û—Å—Ç—Ä—ã–π/—Ö—Ä–æ–Ω–∏—á–µ—Å–∫–∏–π'],
           ['hypertg','üß™ –ì–∏–ø–µ—Ä—Ç—Ä–∏–≥–ª–∏—Ü–µ—Ä–∏–¥–µ–º–∏—è','–¢–ì >11 –º–º–æ–ª—å/–ª'],
           ['ercp','üî≠ –ü–æ—Å–ª–µ –≠–†–•–ü–ì','24‚Äì72 —á –ø–æ—Å–ª–µ –ø—Ä–æ—Ü–µ–¥—É—Ä—ã'],
           ['drug','üíä –ú–µ–¥–∏–∫–∞–º–µ–Ω—Ç–æ–∑–Ω—ã–π','–ê–∑–∞—Ç–∏–æ–ø—Ä–∏–Ω, –¥–∏—É—Ä–µ—Ç–∏–∫–∏'],
           ['trauma','ü§ï –¢—Ä–∞–≤–º–∞—Ç–∏—á–µ—Å–∫–∏–π','–¢—É–ø–∞—è —Ç—Ä–∞–≤–º–∞ –∂–∏–≤–æ—Ç–∞'],
           ['autoimmune','üõ°Ô∏è –ê—É—Ç–æ–∏–º–º—É–Ω–Ω—ã–π','IgG4-–∞—Å—Å–æ—Ü–∏–∏—Ä–æ–≤–∞–Ω–Ω—ã–π'],
           ['idio','‚ùì –ò–¥–∏–æ–ø–∞—Ç–∏—á–µ—Å–∫–∏–π','–ü—Ä–∏—á–∏–Ω–∞ –Ω–µ –≤—ã—è–≤–ª–µ–Ω–∞']
          ].map(function(e){
            return '<button class="eb'+(ST.etio===e[0]?' on':'')+'" onclick="ST.etio=\''+e[0]+'\';R()">'+
              e[1]+'<div class="esub">'+e[2]+'</div></button>';
          }).join('')+
        '</div>'+
      '</div>'+

      // –ù–∞—á–∞–ª–æ —Å–∏–º–ø—Ç–æ–º–æ–≤
      '<div style="margin-top:14px"><div class="sl">–î–∞—Ç–∞ / –≤—Ä–µ–º—è –Ω–∞—á–∞–ª–∞ —Å–∏–º–ø—Ç–æ–º–æ–≤</div>'+
        '<div class="fg2">'+
          '<div class="fl"><div class="flb">–î–∞—Ç–∞</div><input class="fi" type="date" value="'+(ST.onset||'')+'" onchange="ST.onset=this.value;R()"></div>'+
          '<div class="fl"><div class="flb">–í—Ä–µ–º—è</div><input class="fi" type="time" value="'+(ST.onsetT||'')+'" onchange="ST.onsetT=this.value;R()"></div>'+
        '</div>'+
        (ST.onset?'<div class="fconv" style="margin-top:5px">‚è± –î–ª–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å: '+sinceOnset()+'</div>':'')+
      '</div>'+
    '</div>'+
  '</div>'+
  '<div class="btnrow">'+
    '<button class="btn btn-p" onclick="next()" '+(ok?'':'disabled')+'>'+
      (ok?'–î–∞–ª–µ–µ ‚Üí –î–∞–Ω–Ω—ã–µ –ø–∞—Ü–∏–µ–Ω—Ç–∞':'–û—Ç–º–µ—Ç—å—Ç–µ ‚â•2 –∫—Ä–∏—Ç–µ—Ä–∏—è –¥–ª—è –ø—Ä–æ–¥–æ–ª–∂–µ–Ω–∏—è')+
    '</button>'+
  '</div>'+
  '</div>';
}

function checkEnz(){
  var a=pf(ST.diag.amylase),l=pf(ST.diag.lipase);
  if((!a||isNaN(a))&&(!l||isNaN(l)))return;
  if((a&&a>=300)||(l&&l>=180))ST.diag.enzymes=true;
}
function sinceOnset(){
  try{
    var dt=new Date(ST.onset+(ST.onsetT?'T'+ST.onsetT:'T00:00'));
    var h=Math.floor((Date.now()-dt)/3600000);
    if(h<0)return '–≤ –±—É–¥—É—â–µ–º';
    if(h<24)return h+' —á';
    return Math.floor(h/24)+' –¥–Ω '+(h%24)+' —á';
  }catch(e){return '‚Äî';}
}

// ‚îÄ‚îÄ –ü–ê–¶–ò–ï–ù–¢ ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
function pagePat(){
  var p=ST.pat;
  return '<div class="fi-anim">'+
  '<div class="card">'+
    '<div class="ch"><span>üë§</span><span class="ct">–î–∞–Ω–Ω—ã–µ –ø–∞—Ü–∏–µ–Ω—Ç–∞</span></div>'+
    '<div class="cb">'+
      '<div class="fg2">'+
        inpUnit('–í–æ–∑—Ä–∞—Å—Ç','text','pat_age',p.age||'','–ª–µ—Ç','sP(\'age\',this.value)','onBlur()','')+
        inpUnit('–í–µ—Å','text','pat_wt',p.weight||'','–∫–≥','sP(\'weight\',this.value)','onBlur()','')+
      '</div>'+

      // –•—Ä–æ–Ω–∏—á–µ—Å–∫–∏–µ –∑–∞–±–æ–ª–µ–≤–∞–Ω–∏—è ‚Äî –¥–≤–∞ —á—ë—Ç–∫–∏—Ö –≤–∞—Ä–∏–∞–Ω—Ç–∞
      '<div style="margin-top:14px"><div class="sl">–•—Ä–æ–Ω–∏—á–µ—Å–∫–∏–µ –∑–∞–±–æ–ª–µ–≤–∞–Ω–∏—è</div>'+
        '<div class="tg">'+
          '<button class="tb'+((!p.chronicYes)?' ong':'')+'" onclick="ST.pat.chronicYes=false;ST.pat.chronic=\'none\';R()">‚úÖ –ù–µ—Ç</button>'+
          '<button class="tb'+(p.chronicYes?' onr':'')+'" onclick="ST.pat.chronicYes=true;R()">‚ö† –î–∞</button>'+
        '</div>'+
        (p.chronicYes?
          '<div style="margin-top:10px">'+
            '<div class="flb" style="margin-bottom:6px">–¢–∏–ø –¥–ª—è APACHE II</div>'+
            '<select class="fsel" onchange="sDR(\'pat\',\'chronic\',this.value)">'+
              [['elective','–ü–ª–∞–Ω–æ–≤–∞—è / –ø—Ä–µ–¥–ø–ª–∞–Ω–æ–≤–∞—è –æ–ø–µ—Ä–∞—Ü–∏—è (+2 –±)'],
               ['nonop','–ù–µ–æ–ø–µ—Ä–∞—Ç–∏–≤–Ω—ã–π / —ç–∫—Å—Ç—Ä–µ–Ω–Ω—ã–π (+5 –±)']
              ].map(function(o){return '<option value="'+o[0]+'"'+(p.chronic===o[0]?' selected':'')+'>'+o[1]+'</option>';}).join('')+
            '</select>'+
            '<div style="margin-top:8px;font-size:11px;color:var(--t2);line-height:1.6">'+
              '<b style="color:var(--t)">–£—á–∏—Ç—ã–≤–∞—é—Ç—Å—è:</b> —Ü–∏—Ä—Ä–æ–∑ ¬∑ —Ö—Ä–æ–Ω–∏—á–µ—Å–∫–∞—è –ø–æ—á–µ—á–Ω–∞—è/—Å–µ—Ä–¥–µ—á–Ω–∞—è/–ª—ë–≥–æ—á–Ω–∞—è –Ω–µ–¥. ¬∑ –∏–º–º—É–Ω–æ–¥–µ—Ñ–∏—Ü–∏—Ç (–í–ò–ß, –∫–æ—Ä—Ç–∏–∫–æ—Å—Ç–µ—Ä–æ–∏–¥—ã, —Ö–∏–º–∏–æ—Ç–µ—Ä–∞–ø–∏—è)'+
            '</div>'+
          '</div>'
        :
          '<div style="margin-top:6px;font-size:11px;color:var(--t3)">–¶–∏—Ä—Ä–æ–∑, –•–ü–ù, –•–°–ù, –•–û–ë–õ, –∏–º–º—É–Ω–æ–¥–µ—Ñ–∏—Ü–∏—Ç ‚Äî 0 –±–∞–ª–ª–æ–≤ APACHE II</div>'
        )+
      '</div>'+
    '</div>'+
  '</div>'+
  nav2('‚Üê –ù–∞–∑–∞–¥','–î–∞–ª–µ–µ ‚Üí –í–∏—Ç–∞–ª—å–Ω—ã–µ')+
  '</div>';
}

// ‚îÄ‚îÄ –í–ò–¢–ê–õ–¨–ù–´–ï ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
function pageVitals(){
  var d=D(ST.tp),tp=ST.tp;
  var sbp=pf(d.sbp),dbp=pf(d.dbp);
  var mapV=(sbp&&dbp)?((sbp+2*dbp)/3|0):null;
  return '<div class="fi-anim">'+
  tpTabs()+
  '<div class="card">'+
    '<div class="ch"><span>üå°Ô∏è</span><span class="ct">–í–∏—Ç–∞–ª—å–Ω—ã–µ –ø–æ–∫–∞–∑–∞—Ç–µ–ª–∏</span></div>'+
    '<div class="cb">'+
      '<div class="fg">'+
        dInp('–¢–µ–º–ø–µ—Ä–∞—Ç—É—Ä–∞',tp,'temp','¬∞C',{step:'0.1',min:'34',max:'42'})+
        dInp('–ß–°–°',tp,'hr','—É–¥/–º–∏–Ω')+
        dInp('–ß–î–î',tp,'rr','/–º–∏–Ω')+
        dInp('–ê–î —Å–∏—Å—Ç.',tp,'sbp','–º–º —Ä—Ç.—Å—Ç.')+
        dInp('–ê–î –¥–∏–∞—Å—Ç.',tp,'dbp','–º–º —Ä—Ç.—Å—Ç.')+
        dInp('–î–∏—É—Ä–µ–∑',tp,'uo','–º–ª/—Å—É—Ç')+
      '</div>'+
      '<div id="hint_map" class="ib" style="margin-top:9px">'+
        (mapV?'MAP = ('+d.sbp+' + 2√ó'+d.dbp+') / 3 = <b style="color:var(--c)">'+mapV+' –º–º —Ä—Ç.—Å—Ç.</b>':'–í–≤–µ–¥–∏—Ç–µ –ê–î —Å–∏—Å—Ç. –∏ –¥–∏–∞—Å—Ç. –¥–ª—è —Ä–∞—Å—á—ë—Ç–∞ MAP')+
      '</div>'+
    '</div>'+
  '</div>'+
  '<div class="card">'+
    '<div class="ch"><span>üß†</span><span class="ct">–ù–µ—Ä–≤–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞ –∏ —Ç–µ—Ä–∞–ø–∏—è</span></div>'+
    '<div class="cb">'+
      '<div class="fg">'+dInp('–®–ö–ì (GCS)',tp,'gcs','/15',{min:'3',max:'15'})+'</div>'+
      '<div style="margin-top:11px">'+dSel('–°–æ–∑–Ω–∞–Ω–∏–µ',tp,'men',[['normal','–Ø—Å–Ω–æ–µ'],['impaired','–ù–∞—Ä—É—à–µ–Ω–æ (–ª—é–±–∞—è –ø—Ä–∏—á–∏–Ω–∞)']])+'</div>'+
      '<div style="margin-top:11px">'+dSel('–í–∞–∑–æ–ø—Ä–µ—Å—Å–æ—Ä—ã',tp,'vaso',[
        ['none','–ù–µ –ø—Ä–∏–º–µ–Ω—è—é—Ç—Å—è'],
        ['dopa_low','–î–æ–ø–∞–º–∏–Ω ‚â§5 –º–∫–≥/–∫–≥/–º–∏–Ω'],
        ['dopa_mid','–î–æ–ø–∞–º–∏–Ω 5‚Äì15 –º–∫–≥/–∫–≥/–º–∏–Ω'],
        ['dopa_high','–î–æ–ø–∞–º–∏–Ω >15 –º–∫–≥/–∫–≥/–º–∏–Ω'],
        ['epi','–ê–¥—Ä–µ–Ω–∞–ª–∏–Ω / –ù–æ—Ä–∞–¥—Ä–µ–Ω–∞–ª–∏–Ω']
      ])+'</div>'+
    '</div>'+
  '</div>'+

  // SIRS ‚Äî –æ—Ç–¥–µ–ª—å–Ω–∞—è –æ—Ü–µ–Ω–∫–∞
  (function(){
    var d2=D(tp);
    var sc2=calc(tp);
    var sirsN=sc2.sirs;
    var sirsC=sirsN>=3?'var(--r)':sirsN>=2?'var(--y)':'var(--g)';
    var sirsType=d2.sirs_type||'none';
    var mortSirs=sirsType==='persistent'?'25.4%':sirsType==='transient'?'8%':'‚Äî';
    var mortC=sirsType==='persistent'?'var(--r)':sirsType==='transient'?'var(--y)':'var(--t3)';
    return '<div class="card">'+
      '<div class="ch"><span>üî•</span><span class="ct">SIRS ‚Äî –°–∏–Ω–¥—Ä–æ–º —Å–∏—Å—Ç–µ–º–Ω–æ–≥–æ –≤–æ—Å–ø–∞–ª–∏—Ç–µ–ª—å–Ω–æ–≥–æ –æ—Ç–≤–µ—Ç–∞</span></div>'+
      '<div class="cb">'+
        '<div class="ib" style="margin-bottom:10px">'+
          '<b>–ö—Ä–∏—Ç–µ—Ä–∏–∏ SIRS (—Ç–µ–∫—É—â–∏–µ –¥–∞–Ω–Ω—ã–µ: '+sirsN+'/4):</b>'+
          '<div style="margin-top:5px;display:grid;grid-template-columns:1fr 1fr;gap:3px;font-size:11px">'+
            '<span style="color:'+(pf(d2.temp)!==null&&(pf(d2.temp)>38||pf(d2.temp)<36)?'var(--r)':'var(--t3)')+'">'+
              '‚ë† –¢ >38 –∏–ª–∏ <36¬∞C'+(pf(d2.temp)?' ('+pf(d2.temp)+'¬∞C)':' ‚Äî')+'</span>'+
            '<span style="color:'+(pf(d2.hr)!==null&&pf(d2.hr)>90?'var(--r)':'var(--t3)')+'">'+
              '‚ë° –ß–°–° >90'+(pf(d2.hr)?' ('+pf(d2.hr)+')':' ‚Äî')+'</span>'+
            '<span style="color:'+(pf(d2.rr)!==null&&pf(d2.rr)>20?'var(--r)':'var(--t3)')+'">'+
              '‚ë¢ –ß–î–î >20'+(pf(d2.rr)?' ('+pf(d2.rr)+')':' ‚Äî')+'</span>'+
            '<span style="color:'+(pf(d2.wbc)!==null&&(pf(d2.wbc)>12||pf(d2.wbc)<4)?'var(--r)':'var(--t3)')+'">'+
              '‚ë£ –õ–µ–π–∫. >12 –∏–ª–∏ <4'+(pf(d2.wbc)?' ('+pf(d2.wbc)+')':' ‚Äî')+'</span>'+
          '</div>'+
          '<div style="margin-top:6px;font-size:13px;font-weight:700;color:'+sirsC+'">'+
            sirsN+'/4 –∫—Ä–∏—Ç–µ—Ä–∏—è'+(sirsN>=2?' ‚Äî SIRS –ø–æ–¥—Ç–≤–µ—Ä–∂–¥—ë–Ω':'')+'</div>'+
        '</div>'+
        '<div class="sl">–ü—Ä–æ–¥–æ–ª–∂–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å SIRS (–¥–ª—è –æ—Ü–µ–Ω–∫–∏ –ª–µ—Ç–∞–ª—å–Ω–æ—Å—Ç–∏)</div>'+
        '<div class="tg">'+
          '<button class="tb'+(sirsType==='none'?' on':'')+'" onclick="sDR(\''+tp+'\',\'sirs_type\',\'none\')">–ù–µ—Ç / –ù–µ –æ—Ü–µ–Ω–µ–Ω–æ</button>'+
          '<button class="tb'+(sirsType==='transient'?' on':'')+'" onclick="sDR(\''+tp+'\',\'sirs_type\',\'transient\')">‚è± –¢—Ä–∞–Ω–∑–∏—Ç–æ—Ä–Ω—ã–π (&lt;48 —á)</button>'+
          '<button class="tb'+(sirsType==='persistent'?' onr':'')+'" onclick="sDR(\''+tp+'\',\'sirs_type\',\'persistent\')">üî¥ –ü–µ—Ä—Å–∏—Å—Ç–∏—Ä—É—é—â–∏–π (‚â•48 —á)</button>'+
        '</div>'+
        (sirsType!=='none'?
          '<div style="margin-top:9px;padding:9px 12px;border-radius:7px;background:'+mortC+'18;border:1px solid '+mortC+'44;font-size:13px">'+
            '<b style="color:'+mortC+'">–õ–µ—Ç–∞–ª—å–Ω–æ—Å—Ç—å: '+mortSirs+'</b>'+
            '<span style="font-size:11px;color:var(--t2);margin-left:8px">doi: 10.1002/bjs.5290</span>'+
            (sirsType==='persistent'?'<div style="font-size:11px;color:var(--t2);margin-top:4px">‚ö† –ü–µ—Ä—Å–∏—Å—Ç–∏—Ä—É—é—â–∏–π SIRS ‚Äî –Ω–µ–∑–∞–≤–∏—Å–∏–º—ã–π –ø—Ä–µ–¥–∏–∫—Ç–æ—Ä –æ—Ä–≥–∞–Ω–Ω–æ–π –Ω–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ—Å—Ç–∏. –†–µ–∫–ª–∞—Å—Å–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞—Ç—å –≤ —Ç—è–∂—ë–ª—ã–π –û–ü.</div>':'<div style="font-size:11px;color:var(--t2);margin-top:4px">‚úì –¢—Ä–∞–Ω–∑–∏—Ç–æ—Ä–Ω—ã–π SIRS (—Ä–∞–∑—Ä–µ—à–∞–µ—Ç—Å—è &lt;48—á) ‚Äî —É–º–µ—Ä–µ–Ω–Ω–æ-—Ç—è–∂—ë–ª—ã–π –û–ü.</div>')+
          '</div>'
        :'')+
        (sirsN>=2?'<div class="al al-i" style="margin-top:10px;margin-bottom:0">üìã <b>–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ 2025 (DOI: 10.1016/j.pan.2025.01.010):</b> –ù–∞–ª–∏—á–∏–µ SIRS + –º–µ—Å—Ç–Ω—ã–µ –æ—Å–ª–æ–∂–Ω–µ–Ω–∏—è –ø–æ –ö–¢ –¥–æ—Å—Ç–∞—Ç–æ—á–Ω—ã –¥–ª—è –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏–∏ —É–º–µ—Ä–µ–Ω–Ω–æ-—Ç—è–∂—ë–ª–æ–≥–æ –û–ü –±–µ–∑ –æ—Ä–≥–∞–Ω–Ω–æ–π –Ω–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ—Å—Ç–∏.</div>':'')+
      '</div>'+
    '</div>';
  })()+

  // –®–∫–∞–ª–∞ –î–∂–∞–Ω–µ–ª–∏–¥–∑–µ ‚Äî –∫–ª–∏–Ω–∏—á–µ—Å–∫–∏–µ –ø—Ä–∏–∑–Ω–∞–∫–∏
  (function(){
    var d2=D(tp);
    var keys=['dzh_peritoneal','dzh_enceph','dzh_ecg','dzh_exudate','dzh_parapanc','dzh_steatonec','dzh_nofluid'];
    var lbls=['–ü–µ—Ä–∏—Ç–æ–Ω–µ–∞–ª—å–Ω—ã–µ —Å–∏–º–ø—Ç–æ–º—ã','–≠–Ω—Ü–µ—Ñ–∞–ª–æ–ø–∞—Ç–∏—è','–ú–µ—Ç–∞–±–æ–ª–∏—á. –∏–∑–º–µ–Ω–µ–Ω–∏—è –Ω–∞ –≠–ö–ì',
              '–í–∏—à–Ω—ë–≤—ã–π/–∫–æ—Ä–∏—á–Ω–µ–≤–æ-—á—ë—Ä–Ω—ã–π —ç–∫—Å—Å—É–¥–∞—Ç (–ª–∞–ø–∞—Ä–æ-—è)','–†–∞—Å–ø—Ä–æ—Å—Ç—Ä–∞–Ω—ë–Ω–Ω—ã–π –ø–∞—Ä–∞–ø–∞–Ω–∫—Ä–µ–∞—Ç–∏—Ç (–∑–∞ —Å–∞–ª—å–Ω–∏–∫–æ–≤—É—é —Å—É–º–∫—É)',
              '–°—Ç–µ–∞—Ç–æ–Ω–µ–∫—Ä–æ–∑—ã','–ù–µ—Ç —ç—Ñ—Ñ–µ–∫—Ç–∞ –æ—Ç –∏–Ω—Ñ—É–∑–∏–æ–Ω–Ω–æ–π —Ç–µ—Ä–∞–ø–∏–∏'];
    var items=keys.map(function(k,i){
      var on=d2[k]==='yes';
      return '<div class="crit'+(on?' on':'')+'" onclick="sDR(\''+tp+'\',\''+k+'\','+(on?'\'no\'':'\'yes\'')+')">'+
        '<div class="cbox">'+(on?'<span style="font-size:13px;color:#000">‚úì</span>':'')+'</div>'+
        '<div><div class="ctit" style="font-size:13px">'+lbls[i]+'</div></div>'+
      '</div>';
    }).join('');
    return '<div class="card">'+
      '<div class="ch"><span>üìã</span><span class="ct">–®–∫–∞–ª–∞ –î–∂–∞–Ω–µ–ª–∏–¥–∑–µ ‚Äî –∫–ª–∏–Ω–∏—á–µ—Å–∫–∏–µ –ø—Ä–∏–∑–Ω–∞–∫–∏</span></div>'+
      '<div class="cb">'+
        '<div class="al al-i" style="margin-bottom:10px">–û—Ç–º–µ—Ç—å—Ç–µ –∫–ª–∏–Ω–∏—á–µ—Å–∫–∏–µ –ø—Ä–∏–∑–Ω–∞–∫–∏. –õ–∞–±–æ—Ä–∞—Ç–æ—Ä–Ω—ã–µ –∫—Ä–∏—Ç–µ—Ä–∏–∏ —Ä–∞—Å—Å—á–∏—Ç—ã–≤–∞—é—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –∏–∑ –≤–≤–µ–¥—ë–Ω–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö.</div>'+
        items+
      '</div>'+
    '</div>';
  })()+

  nav2('‚Üê –ù–∞–∑–∞–¥','–î–∞–ª–µ–µ ‚Üí –ê–Ω–∞–ª–∏–∑—ã')+
  '</div>';
}

// ‚îÄ‚îÄ –ê–ù–ê–õ–ò–ó–´ ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
function pageLabs(){
  var d=D(ST.tp),tp=ST.tp;
  var urea=pf(d.urea),creat=pf(d.creat),bili=pf(d.bili);
  var na=pf(d.na),k=pf(d.k),alb=pf(d.alb),tp2=pf(d.tp),crp=pf(d.crp);
  return '<div class="fi-anim">'+
  tpTabs()+
  '<div class="card">'+
    '<div class="ch"><span>ü©∏</span><span class="ct">–û–ê–ö</span></div>'+
    '<div class="cb"><div class="fg">'+
      dInp('–õ–µ–π–∫–æ—Ü–∏—Ç—ã',tp,'wbc','√ó10‚Åπ/–ª',{step:'0.1'})+
      dInp('–ì–µ–º–∞—Ç–æ–∫—Ä–∏—Ç',tp,'hct','%',{min:'10',max:'70'})+
      dInp('–¢—Ä–æ–º–±–æ—Ü–∏—Ç—ã',tp,'plt','√ó10‚Åπ/–ª')+
    '</div></div>'+
  '</div>'+
  '<div class="card">'+
    '<div class="ch"><span>üß™</span><span class="ct">–ë–∏–æ—Ö–∏–º–∏—è ‚Äî –ü–æ—á–∫–∏ –∏ —ç–ª–µ–∫—Ç—Ä–æ–ª–∏—Ç—ã</span></div>'+
    '<div class="cb">'+
      '<div class="sl">–ü–æ—á–µ—á–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏—è</div>'+
      '<div class="fg2">'+
        dInp('–ú–æ—á–µ–≤–∏–Ω–∞',tp,'urea','–º–º–æ–ª—å/–ª',{step:'0.1'})+
        dInp('–ö—Ä–µ–∞—Ç–∏–Ω–∏–Ω',tp,'creat','–º–∫–º–æ–ª—å/–ª',{step:'1'})+
      '</div>'+
      '<div id="hint_urea" class="fconv">'+(urea?urea.toFixed(1)+' –º–º–æ–ª—å/–ª = BUN '+(urea2bun(urea)).toFixed(1)+' –º–≥/–¥–ª'+(urea>8.93?' <b style="color:var(--r)">‚ö† BISAP: BUN>25</b>':''):'')+'</div>'+
      '<div id="hint_creat" class="fconv">'+(creat?creat+' –º–∫–º–æ–ª—å/–ª = '+(cr2mgdl(creat)).toFixed(2)+' –º–≥/–¥–ª'+(creat>=309?' <b style="color:var(--r)">SOFA 4</b>':creat>=221?' <b style="color:var(--y)">SOFA 3</b>':creat>=177?' SOFA 2':creat>=106?' SOFA 1':''):'')+'</div>'+

      '<div class="sl" style="margin-top:13px">–≠–ª–µ–∫—Ç—Ä–æ–ª–∏—Ç—ã (–º–º–æ–ª—å/–ª = mEq/L)</div>'+
      '<div class="fg2">'+
        dInp('Na‚Å∫',tp,'na','–º–º–æ–ª—å/–ª',{min:'100',max:'200'})+
        dInp('K‚Å∫',tp,'k','–º–º–æ–ª—å/–ª',{min:'1',max:'10',step:'0.1'})+
      '</div>'+
      '<div id="hint_na" class="fconv">'+(na?'Na: '+(na<130?'‚ö† –ì–∏–ø–æ–Ω–∞—Ç—Ä–∏–µ–º–∏—è':na>150?'‚ö† –ì–∏–ø–µ—Ä–Ω–∞—Ç—Ä–∏–µ–º–∏—è':'–í –Ω–æ—Ä–º–µ (130‚Äì150)'):'')+'</div>'+
      '<div id="hint_k" class="fconv">'+(k?'K: '+(k<3.5?'‚ö† –ì–∏–ø–æ–∫–∞–ª–∏–µ–º–∏—è':k>5.5?'‚ö† –ì–∏–ø–µ—Ä–∫–∞–ª–∏–µ–º–∏—è':'–í –Ω–æ—Ä–º–µ (3.5‚Äì5.5)'):'')+'</div>'+

      '<div class="sl" style="margin-top:13px">–§—É–Ω–∫—Ü–∏—è –ø–µ—á–µ–Ω–∏</div>'+
      '<div class="fg">'+dInp('–ë–∏–ª–∏—Ä—É–±–∏–Ω –æ–±—â–∏–π',tp,'bili','–º–∫–º–æ–ª—å/–ª',{step:'1'})+'</div>'+
      '<div id="hint_bili" class="fconv">'+(bili?bili+' –º–∫–º–æ–ª—å/–ª = '+(bi2mgdl(bili)).toFixed(2)+' –º–≥/–¥–ª'+(bili>=205?' <b style="color:var(--r)">SOFA 4</b>':bili>=102?' <b style="color:var(--y)">SOFA 3</b>':bili>=34?' SOFA 2':bili>=20?' SOFA 1':''):'')+'</div>'+
    '</div>'+
  '</div>'+
  '<div class="card">'+
    '<div class="ch"><span>‚öóÔ∏è</span><span class="ct">–ë–µ–ª–∫–∏ –∏ –≤–æ—Å–ø–∞–ª–µ–Ω–∏–µ ‚Äî NAPP / C–†–ë</span></div>'+
    '<div class="cb">'+
      '<div class="fg">'+
        dInp('–û–±—â–∏–π –±–µ–ª–æ–∫',tp,'tp','–≥/–ª',{step:'0.1'})+
        dInp('–ê–ª—å–±—É–º–∏–Ω',tp,'alb','–≥/–ª',{step:'0.1'})+
        dInp('C–†–ë (CRP)',tp,'crp','–º–≥/–ª',{step:'1'})+
      '</div>'+
      '<div id="hint_napp" class="ib" style="margin-top:9px">'+(alb&&tp2?'NAPP = '+tp2+' ‚àí '+alb+' = <b style="color:'+(tp2-alb>30?'var(--r)':'var(--g)')+'">'+( tp2-alb).toFixed(1)+' –≥/–ª</b>'+(tp2-alb>30?' ‚ö† >30 –≥/–ª ‚Äî —Ä–∏—Å–∫ —Ç—è–∂—ë–ª–æ–≥–æ –û–ü':'  ‚úÖ –Ω–æ—Ä–º–∞'):'–í–≤–µ–¥–∏—Ç–µ –æ–±—â–∏–π –±–µ–ª–æ–∫ –∏ –∞–ª—å–±—É–º–∏–Ω –¥–ª—è NAPP')+'</div>'+
      '<div id="hint_crp" class="fconv">'+(crp?'C–†–ë '+crp+' –º–≥/–ª ‚Üí '+(ST.tp==='24h'?'–ü–∏–∫ –æ–∂–∏–¥–∞–µ—Ç—Å—è –∫ 48—á':crp>=150?'<b style="color:var(--r)">‚â•150 –º–≥/–ª = —Ç—è–∂—ë–ª—ã–π –û–ü</b>':crp>=100?'<b style="color:var(--y)">100‚Äì149 ‚Äî —É–º–µ—Ä–µ–Ω–Ω—ã–π —Ä–∏—Å–∫</b>':'<100 –º–≥/–ª ‚Äî –ª—ë–≥–∫–æ–µ —Ç–µ—á–µ–Ω–∏–µ'):'')+'</div>'+
      '<div style="margin-top:11px">'+dSel('–û–ü–ù (–¥–ª—è APACHE II)',tp,'arf',[['no','–ù–µ—Ç'],['yes','–ï—Å—Ç—å (√ó2 –∫ –±–∞–ª–ª—É –∫—Ä-–Ω–∞)']])+'</div>'+
    '</div>'+
  '</div>'+

  // –ù–æ–≤—ã–µ –ø–æ–ª—è –¥–ª—è Ranson –∏ –î–∂–∞–Ω–µ–ª–∏–¥–∑–µ
  '<div class="card">'+
    '<div class="ch"><span>üî¨</span><span class="ct">–®–∫–∞–ª–∞ Ranson + –î–∂–∞–Ω–µ–ª–∏–¥–∑–µ ‚Äî –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –ø–æ–∫–∞–∑–∞—Ç–µ–ª–∏</span></div>'+
    '<div class="cb">'+
      '<div class="sl">–§–µ—Ä–º–µ–Ω—Ç—ã –∏ –≥–ª—é–∫–æ–∑–∞ (–ø–æ—Å—Ç—É–ø–ª–µ–Ω–∏–µ ‚Äî 24—á)</div>'+
      '<div class="fg">'+
        dInp('–ì–ª—é–∫–æ–∑–∞',tp,'gluc','–º–º–æ–ª—å/–ª',{step:'0.1'})+
        dInp('–ì–µ–º–æ–≥–ª–æ–±–∏–Ω (Hb)',tp,'hb','–≥/–ª',{step:'1'})+
        dInp('–õ–î–ì',tp,'ldh','–ú–ï/–ª',{step:'1'})+
        dInp('–ê–°–¢',tp,'ast','–ú–ï/–ª',{step:'1'})+
      '</div>'+
      (pf(D(tp).gluc)?'<div class="fconv">–ì–ª—é–∫–æ–∑–∞ '+(pf(D(tp).gluc)>11.1?'<b style="color:var(--r)">‚ö† >11.1 –º–º–æ–ª—å/–ª ‚Äî Ranson +1</b>':'–≤ –Ω–æ—Ä–º–µ')+'</div>':'')+
      (pf(D(tp).hb)?'<div class="fconv">Hb '+(pf(D(tp).hb)>160?'<b style="color:var(--r)">‚ö† >160 –≥/–ª ‚Äî –î–∂–∞–Ω–µ–ª–∏–¥–∑–µ +1</b>':'–≤ –Ω–æ—Ä–º–µ –¥–ª—è –î–∂–∞–Ω–µ–ª–∏–¥–∑–µ')+'</div>':'')+
      (pf(D(tp).ldh)?'<div class="fconv">–õ–î–ì '+(pf(D(tp).ldh)>350?'<b style="color:var(--r)">‚ö† >350 –ú–ï/–ª ‚Äî Ranson +1</b>':'–≤ –Ω–æ—Ä–º–µ')+'</div>':'')+
      (pf(D(tp).ast)?'<div class="fconv">–ê–°–¢ '+(pf(D(tp).ast)>250?'<b style="color:var(--r)">‚ö† >250 –ú–ï/–ª ‚Äî Ranson +1</b>':'–≤ –Ω–æ—Ä–º–µ')+'</div>':'')+

      '<div class="sl" style="margin-top:13px">–ü–∞—Ä–∞–º–µ—Ç—Ä—ã —á–µ—Ä–µ–∑ 48—á (–¥–ª—è Ranson 48—á-–∫—Ä–∏—Ç–µ—Ä–∏–µ–≤)</div>'+
      '<div class="fg">'+
        dInp('Ca¬≤‚Å∫',tp,'ca','–º–º–æ–ª—å/–ª',{step:'0.1'})+
        dInp('–î–µ—Ñ–∏—Ü–∏—Ç –æ—Å–Ω–æ–≤–∞–Ω–∏–π',tp,'basedef','–º—ç–∫–≤/–ª',{step:'0.1'})+
        dInp('–°–µ–∫–≤–µ—Å—Ç—Ä–∞—Ü–∏—è –∂–∏–¥–∫–æ—Å—Ç–∏',tp,'fluidseq','–ª –∑–∞ 48—á',{step:'0.1'})+
      '</div>'+
      (pf(D(tp).ca)?'<div class="fconv">Ca '+(pf(D(tp).ca)<2.0?'<b style="color:var(--r)">‚ö† <2.0 –º–º–æ–ª—å/–ª ‚Äî Ranson 48—á +1</b>':'–≤ –Ω–æ—Ä–º–µ')+'</div>':'')+
      (pf(D(tp).basedef)?'<div class="fconv">–î–µ—Ñ–∏—Ü–∏—Ç –æ—Å–Ω–æ–≤–∞–Ω–∏–π '+(pf(D(tp).basedef)>4?'<b style="color:var(--r)">‚ö† >4 –º—ç–∫–≤/–ª ‚Äî Ranson 48—á +1</b>':'–≤ –Ω–æ—Ä–º–µ')+'</div>':'')+
    '</div>'+
  '</div>'+

  nav2('‚Üê –ù–∞–∑–∞–¥','–î–∞–ª–µ–µ ‚Üí –ö–©–° –∏ –ö–¢')+
  '</div>';
}

// ‚îÄ‚îÄ –ö–©–° + –ö–¢ ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
function pageGas(){
  var d=D(ST.tp),tp=ST.tp;
  var pao2=pf(d.pao2),fio2=pf(d.fio2)||0.21,ph=pf(d.ph);
  var pf3=(pao2&&fio2)?Math.round(pao2/fio2):null;
  var ctg=parseInt(d.ctg)||0;
  var nm={none:0,lt30:2,'30to50':4,gt50:6};
  var mctsi=ctg+(nm[d.nec]||0)+(d.ext==='yes'?2:0);
  return '<div class="fi-anim">'+
  tpTabs()+
  '<div class="card">'+
    '<div class="ch"><span>üå¨Ô∏è</span><span class="ct">–ì–∞–∑—ã –∫—Ä–æ–≤–∏ / –û–∫—Å–∏–≥–µ–Ω–∞—Ü–∏—è</span></div>'+
    '<div class="cb">'+
      '<div class="al al-i" style="margin-bottom:10px">üí° pH –≤–≤–æ–¥–∏—Ç—Å—è —Å —Ç–æ—á–∫–æ–π <b>–∏–ª–∏ –∑–∞–ø—è—Ç–æ–π</b>: 7.4 –∏–ª–∏ 7,4 ‚Äî –æ–±–∞ –≤–∞—Ä–∏–∞–Ω—Ç–∞ —Ä–∞–±–æ—Ç–∞—é—Ç</div>'+
      '<div class="fg">'+
        dInp('pH –∞—Ä—Ç–µ—Ä–∏–∞–ª—å–Ω—ã–π',tp,'ph','',{step:'0.01',min:'6.5',max:'8.0'})+
        dInp('PaO‚ÇÇ',tp,'pao2','–º–º —Ä—Ç.—Å—Ç.')+
        dInp('FiO‚ÇÇ',tp,'fio2','0.21‚Äì1.0',{step:'0.01',min:'0.21',max:'1.0'})+
      '</div>'+
      '<div id="hint_ph" class="fconv">'+(ph?'pH '+ph.toFixed(2)+' ‚Üí '+(ph>=7.7?'<b style="color:var(--r)">APACHE +4</b>':ph>=7.6?'<b style="color:var(--r)">APACHE +3</b>':ph>=7.5?'<b style="color:var(--y)">APACHE +1</b>':ph>=7.33?'<span style="color:var(--g)">–ù–æ—Ä–º–∞ (0)</span>':ph>=7.25?'<b style="color:var(--y)">APACHE +2</b>':ph>=7.15?'<b style="color:var(--r)">APACHE +3</b>':'<b style="color:var(--r)">APACHE +4</b>'):'')+'</div>'+
      '<div id="hint_pf" class="ib" style="margin-top:8px">'+(pf3?'PaO‚ÇÇ/FiO‚ÇÇ = <b style="color:var(--c)">'+pf3+'</b> ‚Üí '+(pf3<100?'<b style="color:var(--r)">–¢—è–∂. –î–ù (SOFA 4)</b>':pf3<200?'<b style="color:var(--r)">–î–ù (SOFA 3)</b>':pf3<300?'<b style="color:var(--y)">–£–º–µ—Ä. (SOFA 2)</b>':pf3<400?'–õ—ë–≥–∫–∞—è –î–ù (SOFA 1)':'–ù–æ—Ä–º–∞ (SOFA 0)'):'–í–≤–µ–¥–∏—Ç–µ PaO‚ÇÇ –∏ FiO‚ÇÇ')+'</div>'+
      '<div style="margin-top:11px">'+dSel('–ü–ª–µ–≤—Ä–∞–ª—å–Ω—ã–π –≤—ã–ø–æ—Ç',tp,'ple',[['no','–ù–µ—Ç'],['yes','–ï—Å—Ç—å (BISAP +1 –±–∞–ª–ª)']])+'</div>'+
    '</div>'+
  '</div>'+
  '<div class="card">'+
    '<div class="ch"><span>üñ•Ô∏è</span><span class="ct">–ö–¢ ‚Äî mCTSI (Balthazar)</span></div>'+
    '<div class="cb">'+
      '<div class="al al-i">–û–ø—Ç–∏–º–∞–ª—å–Ω–æ–µ –≤—Ä–µ–º—è: –ö–¢ —Å –∫–æ–Ω—Ç—Ä–∞—Å—Ç–æ–º —á–µ—Ä–µ–∑ 48‚Äì72 —á –∏–ª–∏ –ø—Ä–∏ –∫–ª–∏–Ω–∏—á–µ—Å–∫–æ–º —É—Ö—É–¥—à–µ–Ω–∏–∏</div>'+
      '<div style="margin-bottom:11px">'+dSel('–ö–¢-—Å—Ç–µ–ø–µ–Ω—å (Balthazar A‚ÄìE)',tp,'ctg',[
        ['0','A ‚Äî –ù–æ—Ä–º–∞ (0 –±)'],['1','B ‚Äî –£–≤–µ–ª–∏—á–µ–Ω–∏–µ –ü–ñ (1 –±)'],
        ['2','C ‚Äî –í–æ—Å–ø–∞–ª–µ–Ω–∏–µ –æ–∫—Ä. –∫–ª–µ—Ç—á–∞—Ç–∫–∏ (2 –±)'],
        ['3','D ‚Äî –û–¥–Ω–∞ –∂–∏–¥–∫–æ—Å—Ç–Ω–∞—è –∑–æ–Ω–∞ (3 –±)'],
        ['4','E ‚Äî ‚â•2 –∂–∏–¥–∫. –∑–æ–Ω / –≥–∞–∑ –≤ –ü–ñ (4 –±)']
      ])+'</div>'+
      '<div style="margin-bottom:11px">'+dSel('–ù–µ–∫—Ä–æ–∑ –ø–æ–¥–∂–µ–ª—É–¥–æ—á–Ω–æ–π –∂–µ–ª–µ–∑—ã',tp,'nec',[
        ['none','–ù–µ—Ç (0 –±)'],['lt30','<30% (2 –±)'],['30to50','30‚Äì50% (4 –±)'],['gt50','>50% (6 –±)']
      ])+'</div>'+
      dSel('–í–Ω–µ–ø–∞–Ω–∫—Ä–µ–∞—Ç–∏—á–µ—Å–∫–∏–µ –æ—Å–ª–æ–∂–Ω–µ–Ω–∏—è',tp,'ext',[['no','–ù–µ—Ç (0 –±)'],['yes','–ï—Å—Ç—å: –≤—ã–ø–æ—Ç / —Ç—Ä–æ–º–±–æ–∑ / –ø—Å–µ–≤–¥–æ–∞–Ω–µ–≤—Ä–∏–∑–º–∞ (+2 –±)']])+
      '<div class="ib" style="margin-top:9px">mCTSI = Balthazar '+ctg+' + –ù–µ–∫—Ä–æ–∑ '+(nm[d.nec]||0)+' + –í–Ω–µ–ø–∞–Ω–∫—Ä. '+(d.ext==='yes'?2:0)+' = <b style="color:var(--c)">'+mctsi+' / 10</b> ‚Üí '+
        (mctsi<=1?'<span style="color:var(--g)">–õ—ë–≥–∫–∏–π ¬∑ –ª–µ—Ç–∞–ª—å–Ω–æ—Å—Ç—å ~0%</span>':mctsi<=3?'<span style="color:var(--g)">–õ—ë–≥–∫–∏–π ¬∑ –ª–µ—Ç–∞–ª—å–Ω–æ—Å—Ç—å ~3%</span>':mctsi<=6?'<span style="color:var(--y)">–°—Ä–µ–¥–Ω–∏–π ¬∑ –ª–µ—Ç–∞–ª—å–Ω–æ—Å—Ç—å ~6%</span>':'<span style="color:var(--r)">–¢—è–∂—ë–ª—ã–π ¬∑ –ª–µ—Ç–∞–ª—å–Ω–æ—Å—Ç—å ~17%</span>')+
        '<span style="font-size:10px;color:var(--t3);margin-left:6px">doi: 0.3389/fphys.2019.01002</span>'+
      '</div>'+
    '</div>'+
  '</div>'+
  nav2('‚Üê –ù–∞–∑–∞–¥','–†–µ–∑—É–ª—å—Ç–∞—Ç—ã ‚Üí')+
  '</div>';
}

// ‚îÄ‚îÄ –†–ï–ó–£–õ–¨–¢–ê–¢–´ ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
function pageScores(){
  var sc=calc(ST.tp),d=D(ST.tp),tp=ST.tp;
  function col(c){ return c==='g'?'var(--g)':c==='y'?'var(--y)':'var(--r)'; }

  function scCard(name,full,val,c,rows,verd,verd2){
    return '<div class="sc" style="border-color:'+c+'44">'+
      '<div class="sch" style="background:'+c+'12;border-color:'+c+'33">'+
        '<div><div class="scn">'+name+'</div><div class="scfn">'+full+'</div></div>'+
        '<div class="scv" style="color:'+c+'">'+val+'</div>'+
      '</div>'+
      '<div class="scb">'+
        rows.map(function(r){
          return '<div class="sr"><span class="srl">'+r[0]+'</span><span class="srv" style="color:'+(r[2]||'var(--t)')+'">'+r[1]+'</span></div>';
        }).join('')+
        '<div class="svrd" style="background:'+c+'15;border-color:'+c+'33">'+
          '<div class="svt" style="color:'+c+'">'+verd+'</div>'+
          (verd2?'<div class="svs">'+verd2+'</div>':'')+
        '</div>'+
      '</div>'+
    '</div>';
  }

  var biSev=sc.bisap>=3?'–¢—è–∂—ë–ª—ã–π':sc.bisap>=2?'–°—Ä–µ–¥–Ω–µ–π —Ç—è–∂–µ—Å—Ç–∏':'–õ—ë–≥–∫–∏–π';
  var apSev=sc.apache>=20?'–ö—Ä–∞–π–Ω–µ —Ç—è–∂—ë–ª—ã–π':sc.apache>=12?'–¢—è–∂—ë–ª—ã–π':sc.apache>=8?'–°—Ä–µ–¥–Ω–µ–π —Ç—è–∂–µ—Å—Ç–∏':'–õ—ë–≥–∫–∏–π';
  var soSev=sc.sofa>=7?'–ü–æ–ª–∏–æ—Ä–≥–∞–Ω–Ω–∞—è –Ω–µ–¥.':sc.sofa>=4?'–¢—è–∂—ë–ª–∞—è –¥–∏—Å—Ñ.':sc.sofa>=2?'–£–º–µ—Ä–µ–Ω–Ω–∞—è –¥–∏—Å—Ñ.':'–ú–∏–Ω–∏–º–∞–ª—å–Ω–∞—è';
  var mcSev=sc.mctsi>=7?'–¢—è–∂—ë–ª—ã–π':sc.mctsi>=4?'–°—Ä–µ–¥–Ω–µ–π —Ç—è–∂–µ—Å—Ç–∏':sc.mctsi>=2?'–õ—ë–≥–∫–∏–π':'–õ—ë–≥–∫–∏–π';
  var mcMort=sc.mctsi>=7?'~17%':sc.mctsi>=4?'~6%':sc.mctsi>=2?'~3%':'<1%';

  // SIRS
  var sirsType=d.sirs_type||'none';
  var sirsMort=sirsType==='persistent'?'25.4%':sirsType==='transient'?'8%':'‚Äî';
  var sirsC2=sirsType==='persistent'?'var(--r)':sirsType==='transient'?'var(--y)':'var(--t3)';

  // Ranson
  var ran=calcRanson();
  var ranC=ran.sev==='r'?'var(--r)':ran.sev==='y'?'var(--y)':'var(--g)';

  // –î–∂–∞–Ω–µ–ª–∏–¥–∑–µ
  var dzh=calcDzhanelidge(tp);
  var dzhC=dzh.sev==='r'?'var(--r)':dzh.sev==='y'?'var(--y)':'var(--g)';

  var sev=sc.apache>=8||sc.bisap>=3||sc.sofa>=6||ran.score>=3||dzh.score>=5?'r':
          sc.apache>=5||sc.bisap>=2||sc.sofa>=3||ran.score>=2||dzh.score>=2?'y':'g';
  var sevC=sev==='r'?'var(--r)':sev==='y'?'var(--y)':'var(--g)';
  var sevL=sev==='r'?'üö® –¢–Ø–ñ–Å–õ–´–ô –û–ü':sev==='y'?'‚ö†Ô∏è –°–†–ï–î–ù–ï–ô –¢–Ø–ñ–ï–°–¢–ò':'‚úÖ –õ–Å–ì–ö–ò–ô –û–ü';

  return '<div class="fi-anim">'+
  tpTabs()+
  '<div class="sgrid">'+

  scCard('BISAP','Bedside Index Severity AP',sc.bisap,sc.biC,[
    ['BUN >25 –º–≥/–¥–ª (–º–æ—á–µ–≤–∏–Ω–∞ >8.93 –º–º–æ–ª—å/–ª)',sc.bun&&sc.bun>25?'+1':'0',sc.bun&&sc.bun>25?'var(--r)':'var(--t2)'],
    ['–ù–∞—Ä—É—à–µ–Ω–∏–µ —Å–æ–∑–Ω–∞–Ω–∏—è',d.men==='impaired'?'+1':'0'],
    ['SIRS ‚â•2 –∫—Ä–∏—Ç–µ—Ä–∏—è (—Å–µ–π—á–∞—Å '+sc.sirs+'/4)',sc.sirs>=2?'+1':'0',sc.sirs>=2?'var(--r)':'var(--t2)'],
    ['–í–æ–∑—Ä–∞—Å—Ç >60 –ª–µ—Ç',(pf(ST.pat.age)||0)>60?'+1':'0'],
    ['–ü–ª–µ–≤—Ä–∞–ª—å–Ω—ã–π –≤—ã–ø–æ—Ç',d.ple==='yes'?'+1':'0']
  ],biSev,'–õ–µ—Ç–∞–ª—å–Ω–æ—Å—Ç—å ‚âà '+sc.biMort)+

  scCard('APACHE II','Acute Physiology & Chronic Health',sc.apache,sc.apC,[
    ['APS (12 —Ñ–∏–∑–∏–æ–ª. –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö)',sc.aps+' / 60'],
    ['–í–æ–∑—Ä–∞—Å—Ç–Ω–æ–π –±–∞–ª–ª','+'+sc.ageS+' / 6'],
    ['–•—Ä–æ–Ω–∏—á–µ—Å–∫–∏–µ –∑–∞–±–æ–ª–µ–≤–∞–Ω–∏—è','+'+sc.chrS+' / 5'],
    ['–ò–¢–û–ì–û',sc.apache,sc.apC]
  ],apSev,'–õ–µ—Ç–∞–ª—å–Ω–æ—Å—Ç—å ‚âà '+sc.apMort+(tp==='24h'?' ¬∑ ‚ö† –ø–µ—Ä–µ—Å—á–∏—Ç–∞—Ç—å –ø—Ä–∏ 48—á':''))+

  scCard('SOFA','Sequential Organ Failure Assessment',sc.sofa,sc.soC,[
    ['–î—ã—Ö–∞–Ω–∏–µ (PaO‚ÇÇ/FiO‚ÇÇ)',sc.resp+'/4',sc.resp>=3?'var(--r)':sc.resp>=2?'var(--y)':'var(--t2)'],
    ['–ö–æ–∞–≥—É–ª—è—Ü–∏—è (—Ç—Ä–æ–º–±–æ—Ü–∏—Ç—ã)',sc.coag+'/4',sc.coag>=3?'var(--r)':sc.coag>=2?'var(--y)':'var(--t2)'],
    ['–ü–µ—á–µ–Ω—å (–±–∏–ª–∏—Ä—É–±–∏–Ω –º–∫–º–æ–ª—å/–ª)',sc.liver+'/4',sc.liver>=3?'var(--r)':sc.liver>=2?'var(--y)':'var(--t2)'],
    ['–ö–∞—Ä–¥–∏–æ (–≤–∞–∑–æ–ø—Ä–µ—Å—Å–æ—Ä—ã/MAP)',sc.cardio+'/4',sc.cardio>=3?'var(--r)':sc.cardio>=2?'var(--y)':'var(--t2)'],
    ['–¶–ù–° (–®–ö–ì)',sc.cns+'/4'],
    ['–ü–æ—á–∫–∏ (–∫—Ä-–Ω –º–∫–º–æ–ª—å/–ª / –¥–∏—É—Ä–µ–∑)',sc.renal+'/4',sc.renal>=3?'var(--r)':sc.renal>=2?'var(--y)':'var(--t2)']
  ],soSev,(sc.sofa>=2?'‚ö† SOFA ‚â•2 ‚Üí –ª–µ—Ç–∞–ª—å–Ω–æ—Å—Ç—å >10%':'SOFA <2 ‚Üí –ª–µ—Ç–∞–ª—å–Ω–æ—Å—Ç—å <10%'))+

  scCard('mCTSI','Modified CT Severity Index',sc.mctsi,sc.mcC,[
    ['Balthazar (A‚ÜíE)',sc.ctg+' / 4'],
    ['–ù–µ–∫—Ä–æ–∑ –ü–ñ',sc.mctsi-sc.ctg-(d.ext==='yes'?2:0)+' / 6'],
    ['–í–Ω–µ–ø–∞–Ω–∫—Ä–µ–∞—Ç. –æ—Å–ª.',d.ext==='yes'?'2 / 2':'0 / 2']
  ],mcSev,'–õ–µ—Ç–∞–ª—å–Ω–æ—Å—Ç—å ‚âà '+mcMort+' ¬∑ doi: 10.3389/fphys.2019.01002')+

  // Ranson
  scCard('Ranson','–ö—Ä–∏—Ç–µ—Ä–∏–∏ Ranson (–ø—Ä–∏ –ø–æ—Å—Ç—É–ø–ª–µ–Ω–∏–∏ + 48—á)',ran.score,ranC,[
    ['–í–æ–∑—Ä–∞—Å—Ç >55 –ª–µ—Ç',ran.pts[0].val?'+1':'0',ran.pts[0].val?'var(--r)':'var(--t2)'],
    ['–õ–µ–π–∫–æ—Ü–∏—Ç—ã >16√ó10‚Åπ/–ª',ran.pts[1].val?'+1':'0',ran.pts[1].val?'var(--r)':'var(--t2)'],
    ['–ì–ª—é–∫–æ–∑–∞ >11.1 –º–º–æ–ª—å/–ª',ran.pts[2].val?'+1':'0',ran.pts[2].val?'var(--r)':'var(--t2)'],
    ['–õ–î–ì >350 –ú–ï/–ª',ran.pts[3].val?'+1':'0',ran.pts[3].val?'var(--r)':'var(--t2)'],
    ['–ê–°–¢ >250 –ú–ï/–ª',ran.pts[4].val?'+1':'0',ran.pts[4].val?'var(--r)':'var(--t2)'],
    ['‚ÜìHt >10% –∑–∞ 48—á',ran.pts[5].val?'+1':'0',ran.pts[5].val?'var(--r)':'var(--t2)'],
    ['‚Üë–ú–æ—á–µ–≤–∏–Ω–∞ >1.8 –º–º–æ–ª—å/–ª –∑–∞ 48—á',ran.pts[6].val?'+1':'0',ran.pts[6].val?'var(--r)':'var(--t2)'],
    ['Ca <2.0 –º–º–æ–ª—å/–ª (48—á)',ran.pts[7].val?'+1':'0',ran.pts[7].val?'var(--r)':'var(--t2)'],
    ['PaO‚ÇÇ <60 –º–º —Ä—Ç.—Å—Ç. (48—á)',ran.pts[8].val?'+1':'0',ran.pts[8].val?'var(--r)':'var(--t2)'],
    ['–î–µ—Ñ–∏—Ü–∏—Ç –æ—Å–Ω. >4 –º—ç–∫–≤/–ª (48—á)',ran.pts[9].val?'+1':'0',ran.pts[9].val?'var(--r)':'var(--t2)'],
    ['–°–µ–∫–≤–µ—Å—Ç—Ä. –∂–∏–¥–∫–æ—Å—Ç–∏ >6 –ª (48—á)',ran.pts[10].val?'+1':'0',ran.pts[10].val?'var(--r)':'var(--t2)']
  ],ran.sevLbl,'–õ–µ—Ç–∞–ª—å–Ω–æ—Å—Ç—å: ‚â§2 –± ‚Üí <1% ¬∑ 3‚Äì4 –± ‚Üí ~15% ¬∑ 5‚Äì6 –± ‚Üí ~40% ¬∑ ‚â•7 –± ‚Üí >50%')+

  // –®–∫–∞–ª–∞ –î–∂–∞–Ω–µ–ª–∏–¥–∑–µ
  (function(){
    var dz=calcDzhanelidge(tp);
    var c=dzhC;
    var rows=dz.crit.map(function(cr){
      return [cr.lbl+(cr.auto&&cr.hint?' ('+cr.hint+')':''),cr.val?'+1':'0',cr.val?'var(--r)':'var(--t2)'];
    });
    return scCard('–î–∂–∞–Ω–µ–ª–∏–¥–∑–µ','–®–∫–∞–ª–∞ –î–∂–∞–Ω–µ–ª–∏–¥–∑–µ (–∏–Ω—Ñ–∏—Ü–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –Ω–µ–∫—Ä–æ–∑)',dz.score,c,rows,
      dz.sevLbl,'0‚Äì1: –ª—ë–≥–∫–∏–π ¬∑ 2‚Äì4: —Å—Ä–µ–¥–Ω–µ–π —Ç—è–∂–µ—Å—Ç–∏ ¬∑ ‚â•5: —Ç—è–∂—ë–ª—ã–π');
  })()+

  // SIRS –æ—Ç–¥–µ–ª—å–Ω–∞—è –∫–∞—Ä—Ç–æ—á–∫–∞
  '<div class="sc" style="border-color:'+sirsC2+'44">'+
    '<div class="sch" style="background:'+sirsC2+'12;border-color:'+sirsC2+'33">'+
      '<div><div class="scn">SIRS</div><div class="scfn">–°–∏—Å—Ç–µ–º–Ω—ã–π –≤–æ—Å–ø–∞–ª–∏—Ç–µ–ª—å–Ω—ã–π –æ—Ç–≤–µ—Ç</div></div>'+
      '<div class="scv" style="color:'+sirsC2+'">'+sc.sirs+'/4</div>'+
    '</div>'+
    '<div class="scb">'+
      ['–¢ >38 –∏–ª–∏ <36¬∞C','–ß–°–° >90/–º–∏–Ω','–ß–î–î >20/–º–∏–Ω','–õ–µ–π–∫. >12 –∏–ª–∏ <4√ó10‚Åπ/–ª'].map(function(lbl,i){
        var v=[pf(d.temp)!==null&&(pf(d.temp)>38||pf(d.temp)<36),
               pf(d.hr)!==null&&pf(d.hr)>90,
               pf(d.rr)!==null&&pf(d.rr)>20,
               pf(d.wbc)!==null&&(pf(d.wbc)>12||pf(d.wbc)<4)][i];
        return '<div class="sr"><span class="srl">'+lbl+'</span><span class="srv" style="color:'+(v?'var(--r)':'var(--t2)')+'">'+( v?'‚úì –î–∞':'‚Äî')+'</span></div>';
      }).join('')+
      '<div class="sr"><span class="srl">–ü—Ä–æ–¥–æ–ª–∂–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å</span><span class="srv" style="color:'+sirsC2+'">'+
        (sirsType==='persistent'?'üî¥ –ü–µ—Ä—Å–∏—Å—Ç–∏—Ä—É—é—â–∏–π':sirsType==='transient'?'‚è± –¢—Ä–∞–Ω–∑–∏—Ç–æ—Ä–Ω—ã–π':'–ù–µ —É–∫–∞–∑–∞–Ω–∞')+
      '</span></div>'+
      (sirsType!=='none'?
        '<div class="svrd" style="background:'+sirsC2+'15;border-color:'+sirsC2+'33">'+
          '<div class="svt" style="color:'+sirsC2+'">–õ–µ—Ç–∞–ª—å–Ω–æ—Å—Ç—å: '+sirsMort+'</div>'+
          '<div class="svs">doi: 10.1002/bjs.5290 ¬∑ —Ç—Ä–∞–Ω–∑–∏—Ç. 8% ¬∑ –ø–µ—Ä—Å–∏—Å—Ç. 25.4%</div>'+
        '</div>':'')+
    '</div>'+
  '</div>'+

  // NAPP + CRP
  '<div class="sc" style="border-color:'+(sc.napp&&parseFloat(sc.napp)>30?'var(--r)':'var(--bd)')+'44">'+
    '<div class="sch" style="background:var(--bg3);border-color:var(--bd)">'+
      '<div><div class="scn">NAPP / C–†–ë</div><div class="scfn">–ë–µ–ª–∫–∏ –∏ –≤–æ—Å–ø–∞–ª–µ–Ω–∏–µ</div></div>'+
      '<div class="scv" style="color:'+(sc.napp&&parseFloat(sc.napp)>30?'var(--r)':'var(--g)')+';font-size:18px;padding-top:4px">'+
        (sc.napp?sc.napp+' –≥/–ª':'‚Äî')+'</div>'+
    '</div>'+
    '<div class="scb">'+
      '<div class="sr"><span class="srl">–û–±—â–∏–π –±–µ–ª–æ–∫</span><span class="srv">'+(d.tp?d.tp+' –≥/–ª':'‚Äî')+'</span></div>'+
      '<div class="sr"><span class="srl">–ê–ª—å–±—É–º–∏–Ω</span><span class="srv">'+(d.alb?d.alb+' –≥/–ª':'‚Äî')+'</span></div>'+
      '<div class="sr"><span class="srl">NAPP = –û–ë ‚àí –ê–ª—å–±</span><span class="srv" style="color:'+(sc.napp&&parseFloat(sc.napp)>30?'var(--r)':'var(--g)')+'">'+(sc.napp?sc.napp+' –≥/–ª':'‚Äî')+'</span></div>'+
      (sc.napp?'<div class="svrd" style="background:'+(parseFloat(sc.napp)>30?'#ef434315':'#10c98a15')+';border-color:'+(parseFloat(sc.napp)>30?'#ef434333':'#10c98a33')+'">'+
        '<div class="svt" style="color:'+(parseFloat(sc.napp)>30?'var(--r)':'var(--g)')+'">'+(parseFloat(sc.napp)>30?'‚ö† –†–∏—Å–∫ —Ç—è–∂—ë–ª–æ–≥–æ —Ç–µ—á–µ–Ω–∏—è':'‚úÖ –í –Ω–æ—Ä–º–µ')+'</div>'+
        '<div class="svs">–ü–æ—Ä–æ–≥: NAPP >30 –≥/–ª</div>'+
      '</div>':'')+
      '<div style="margin-top:10px;border-top:1px solid var(--bd);padding-top:10px">'+
        '<div class="sr"><span class="srl">C–†–ë ('+tp+')</span><span class="srv" style="color:'+sc.crpC+'">'+(sc.crp?sc.crp+' –º–≥/–ª':'‚Äî')+'</span></div>'+
        (sc.crp?'<div class="fconv">'+(tp==='24h'?'–ü–∏–∫ –æ–∂–∏–¥–∞–µ—Ç—Å—è –∫ 48—á':sc.crp>=150?'<b style="color:var(--r)">‚â•150 –º–≥/–ª = —Ç—è–∂—ë–ª—ã–π –û–ü</b>':sc.crp>=100?'<b style="color:var(--y)">100‚Äì149 ‚Äî —É–º–µ—Ä–µ–Ω–Ω—ã–π</b>':'<100 –º–≥/–ª ‚Äî –ª—ë–≥–∫–æ–µ —Ç–µ—á–µ–Ω–∏–µ')+'</div>':'')+
      '</div>'+
    '</div>'+
  '</div>'+

  // –ò—Ç–æ–≥–æ–≤—ã–π –≤–µ—Ä–¥–∏–∫—Ç
  '<div class="sc" style="border-color:'+sevC+'55;grid-column:1/-1">'+
    '<div class="sch" style="background:'+sevC+'18;border-color:'+sevC+'44">'+
      '<div><div class="scn" style="font-size:16px">'+sevL+'</div><div class="scfn">–ò—Ç–æ–≥–æ–≤–∞—è –æ—Ü–µ–Ω–∫–∞ ¬∑ '+tp+'</div></div>'+
    '</div>'+
    '<div class="scb">'+
      '<div style="display:flex;gap:14px;flex-wrap:wrap;margin-bottom:12px">'+
        [['BISAP',sc.bisap,'/5'],['APACHE II',sc.apache,''],['SOFA',sc.sofa,'/24'],['mCTSI',sc.mctsi,'/10'],['Ranson',ran.score,'/11'],['–î–∂–∞–Ω–µ–ª.',dzh.score,'/13']].map(function(x){
          return '<div style="text-align:center">'+
            '<div style="font-size:10px;color:var(--t2);text-transform:uppercase">'+x[0]+'</div>'+
            '<div style="font-size:22px;font-weight:700;font-family:\'Courier New\';color:'+sevC+'">'+x[1]+'<span style="font-size:11px;color:var(--t3)">'+x[2]+'</span></div>'+
          '</div>';
        }).join('')+
      '</div>'+
      (sirsType!=='none'?
        '<div style="padding:7px 11px;border-radius:6px;background:'+sirsC2+'15;border:1px solid '+sirsC2+'33;font-size:12px;margin-top:4px">'+
          '<b style="color:'+sirsC2+'">SIRS '+( sirsType==='persistent'?'–ø–µ—Ä—Å–∏—Å—Ç–∏—Ä—É—é—â–∏–π ‚Üí –ª–µ—Ç–∞–ª—å–Ω–æ—Å—Ç—å 25.4%':'—Ç—Ä–∞–Ω–∑–∏—Ç–æ—Ä–Ω—ã–π ‚Üí –ª–µ—Ç–∞–ª—å–Ω–æ—Å—Ç—å 8%')+'</b>'+
        '</div>':'')+
    '</div>'+
  '</div>'+

  '</div>'+
  nav2('‚Üê –ù–∞–∑–∞–¥','–î–∏–Ω–∞–º–∏–∫–∞ ‚Üí')+
  '</div>';
}

// ‚îÄ‚îÄ –î–ò–ù–ê–ú–ò–ö–ê ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
function pageDyn(){
  var tps=['24h','48h','72h'];
  function col(c){ return c==='g'?'var(--g)':c==='y'?'var(--y)':'var(--r)'; }
  var rows=[
    {lbl:'BISAP',max:5,get:function(sc){return sc.bisap;},gc:function(sc){return sc.bisap>=3?'r':sc.bisap>=2?'y':'g';}},
    {lbl:'APACHE II',max:71,get:function(sc){return sc.apache;},gc:function(sc){return sc.apache>=12?'r':sc.apache>=8?'y':'g';}},
    {lbl:'SOFA',max:24,get:function(sc){return sc.sofa;},gc:function(sc){return sc.sofa>=7?'r':sc.sofa>=4?'y':'g';}},
    {lbl:'mCTSI',max:10,get:function(sc){return sc.mctsi;},gc:function(sc){return sc.mctsi>=7?'r':sc.mctsi>=4?'y':'g';}},
    {lbl:'Ranson',max:11,getR:true,get:function(){return calcRanson().score;},gc:function(){var s=calcRanson().score;return s>=5?'r':s>=3?'y':'g';}},
    {lbl:'–î–∂–∞–Ω–µ–ª–∏–¥–∑–µ',max:13,getDzh:true,get:function(sc,t){return calcDzhanelidge(t).score;},gc:function(sc,t){var s=calcDzhanelidge(t).score;return s>=5?'r':s>=2?'y':'g';}},
    {lbl:'NAPP –≥/–ª',max:60,get:function(sc){return sc.napp?parseFloat(sc.napp):null;},gc:function(sc){return sc.napp&&parseFloat(sc.napp)>30?'r':'g';}},
    {lbl:'C–†–ë –º–≥/–ª',max:400,get:function(sc){return sc.crp;},gc:function(sc){return sc.crp?(sc.crp>=150?'r':sc.crp>=100?'y':'g'):'g';}}
  ];
  return '<div class="fi-anim">'+
  '<div class="al al-i">–î–∞–Ω–Ω—ã–µ 24—á / 48—á / 72—á –≤–≤–æ–¥—è—Ç—Å—è –Ω–∞ –≤–∫–ª–∞–¥–∫–∞—Ö ¬´–í–∏—Ç–∞–ª—å–Ω—ã–µ¬ª –∏ ¬´–ê–Ω–∞–ª–∏–∑—ã¬ª</div>'+
  '<div class="card">'+
    '<div class="ch"><span>üìà</span><span class="ct">–°—Ä–∞–≤–Ω–µ–Ω–∏–µ 24 / 48 / 72 —á–∞—Å–∞</span></div>'+
    '<div class="cb" style="padding:0;overflow-x:auto">'+
      '<table class="ctbl">'+
        '<thead><tr><th>–®–∫–∞–ª–∞</th>'+tps.map(function(t){return '<th style="color:var(--c);text-align:center">'+t+'</th>';}).join('')+'<th>–¢—Ä–µ–Ω–¥</th></tr></thead>'+
        '<tbody>'+
          rows.map(function(row){
            var vals=tps.map(function(t){
              if(!ST.data[t]||ST.data[t].temp===undefined)return null;
              if(row.getDzh)return calcDzhanelidge(t).score;
              if(row.getR)return calcRanson().score;
              return row.get(calc(t));
            });
            var nums=vals.filter(function(v){return v!==null&&!isNaN(v);});
            var trend='‚Äî',tc='';
            if(nums.length>=2){
              var diff=nums[nums.length-1]-nums[0];
              if(diff>1){trend='‚Üë –£—Ö—É–¥—à.';tc='tu';}
              else if(diff<-1){trend='‚Üì –£–ª—É—á—à.';tc='td';}
              else{trend='‚Üí –°—Ç–∞–±.';tc='tf';}
            }
            return '<tr><td style="font-weight:600">'+row.lbl+'</td>'+
              vals.map(function(v,i){
                var t2=tps[i];
                var hasD=ST.data[t2]&&ST.data[t2].temp!==undefined;
                var sc2=hasD?calc(t2):null;
                var colorKey=row.getDzh?row.gc(null,t2):row.gc(sc2,t2);
                var c=hasD?(colorKey==='r'?'var(--r)':colorKey==='y'?'var(--y)':'var(--g)'):'var(--t3)';
                var pct=v!==null&&!isNaN(v)?Math.min(v/row.max*100,100):0;
                return '<td style="text-align:center">'+
                  '<div class="tpv" style="color:'+c+'">'+(v!==null&&!isNaN(v)?v:'‚Äî')+'</div>'+
                  '<div style="height:3px;background:var(--bd);border-radius:2px;margin-top:3px;overflow:hidden">'+
                    '<div style="height:100%;width:'+pct+'%;background:'+c+'"></div>'+
                  '</div>'+
                '</td>';
              }).join('')+
              '<td class="'+tc+'" style="font-weight:700;white-space:nowrap">'+trend+'</td></tr>';
          }).join('')+
        '</tbody>'+
      '</table>'+
    '</div>'+
  '</div>'+
  '<div style="display:grid;grid-template-columns:repeat(3,1fr);gap:9px;margin-bottom:12px">'+
    tps.map(function(t){
      if(!ST.data[t]||ST.data[t].temp===undefined) return '<div class="card" style="padding:13px;text-align:center;color:var(--t3);font-size:12px">–ù–µ—Ç –¥–∞–Ω–Ω—ã—Ö<br><b>'+t+'</b></div>';
      var sc=calc(t);
      var sv=sc.apache>=8||sc.bisap>=3||sc.sofa>=6?'r':sc.apache>=5||sc.bisap>=2||sc.sofa>=3?'y':'g';
      var c=sv==='r'?'var(--r)':sv==='y'?'var(--y)':'var(--g)';
      var l=sv==='r'?'–¢–Ø–ñ–Å–õ–´–ô':sv==='y'?'–°–†–ï–î–ù–ò–ô':'–õ–Å–ì–ö–ò–ô';
      return '<div class="card" style="border-color:'+c+'44"><div style="padding:11px;text-align:center">'+
        '<div style="font-family:\'Courier New\';font-size:17px;color:var(--c);font-weight:700">'+t+'</div>'+
        '<div style="font-weight:700;color:'+c+';font-size:13px;margin-top:4px">'+l+'</div>'+
        '<div style="font-size:10px;color:var(--t3);margin-top:3px">AP'+sc.apache+'¬∑BI'+sc.bisap+'¬∑SO'+sc.sofa+'¬∑CT'+sc.mctsi+'</div>'+
      '</div></div>';
    }).join('')+
  '</div>'+
  nav2('‚Üê –ù–∞–∑–∞–¥','–ù–∞–ø–æ–º–∏–Ω–∞–Ω–∏—è ‚Üí')+
  '</div>';
}

// ‚îÄ‚îÄ –ù–ê–ü–û–ú–ò–ù–ê–ù–ò–Ø ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
var REMS={
  '24h':[
    {id:'a1',t:'–û–ê–ö: –ª–µ–π–∫–æ—Ü–∏—Ç—ã, –≥–µ–º–∞—Ç–æ–∫—Ä–∏—Ç, —Ç—Ä–æ–º–±–æ—Ü–∏—Ç—ã',p:'r'},
    {id:'a2',t:'–ë–∏–æ—Ö–∏–º–∏—è: –º–æ—á–µ–≤–∏–Ω–∞, Na, K, –∫—Ä–µ–∞—Ç–∏–Ω–∏–Ω, –±–∏–ª–∏—Ä—É–±–∏–Ω',p:'r'},
    {id:'a3',t:'–ê–º–∏–ª–∞–∑–∞ / –õ–∏–ø–∞–∑–∞',p:'r'},
    {id:'a4',t:'–ö–©–° –∞—Ä—Ç–µ—Ä–∏–∞–ª—å–Ω–æ–π –∫—Ä–æ–≤–∏ (pH, PaO‚ÇÇ, FiO‚ÇÇ)',p:'r'},
    {id:'a5',t:'C–†–ë ‚Äî –∏—Å—Ö–æ–¥–Ω–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ',p:'y'},
    {id:'a6',t:'–û–±—â–∏–π –±–µ–ª–æ–∫ + –∞–ª—å–±—É–º–∏–Ω (NAPP)',p:'y'},
    {id:'a7',t:'–£–ó–ò –æ—Ä–≥–∞–Ω–æ–≤ –±—Ä—é—à–Ω–æ–π –ø–æ–ª–æ—Å—Ç–∏',p:'r'},
    {id:'a8',t:'–ì–µ–º–æ–∫—É–ª—å—Ç—É—Ä–∞ √ó2 –ø—Ä–∏ –¢ >38.5¬∞C',p:'y'},
    {id:'a9',t:'–≠–ö–ì –ø—Ä–∏ –ø–æ—Å—Ç—É–ø–ª–µ–Ω–∏–∏',p:'y'},
    {id:'a10',t:'–¢—Ä–∏–≥–ª–∏—Ü–µ—Ä–∏–¥—ã (–ø—Ä–∏ –Ω–µ—è—Å–Ω–æ–π —ç—Ç–∏–æ–ª–æ–≥–∏–∏)',p:'b'}
  ],
  '48h':[
    {id:'b1',t:'C–†–ë ‚Äî –∫–ª—é—á–µ–≤–æ–π –º–∞—Ä–∫–µ—Ä —Ç—è–∂–µ—Å—Ç–∏ (–ø–æ—Ä–æ–≥ ‚â•150 –º–≥/–ª)',p:'r'},
    {id:'b2',t:'–ü–æ–≤—Ç–æ—Ä–Ω—ã–π –û–ê–ö, –±–∏–æ—Ö–∏–º–∏—è, —ç–ª–µ–∫—Ç—Ä–æ–ª–∏—Ç—ã',p:'r'},
    {id:'b3',t:'–ü–µ—Ä–µ—Å—á—ë—Ç APACHE II, BISAP, SOFA',p:'r'},
    {id:'b4',t:'–ö–¢ —Å –∫–æ–Ω—Ç—Ä–∞—Å—Ç–æ–º –ø—Ä–∏ –Ω–∞—Ä–∞—Å—Ç–∞–Ω–∏–∏ —Å–∏–º–ø—Ç–æ–º–æ–≤',p:'y'},
    {id:'b5',t:'–ö–æ–Ω—Ç—Ä–æ–ª—å –±–∞–ª–∞–Ω—Å–∞ –∂–∏–¥–∫–æ—Å—Ç–∏ (–¥–∏—É—Ä–µ–∑ ‚â•0.5 –º–ª/–∫–≥/—á)',p:'r'},
    {id:'b6',t:'–ì–ª–∏–∫–µ–º–∏—è –∫–∞–∂–¥—ã–µ 4‚Äì6 —á (—Ü–µ–ª—å <10 –º–º–æ–ª—å/–ª)',p:'y'},
    {id:'b7',t:'–ü—Ä–æ–∫–∞–ª—å—Ü–∏—Ç–æ–Ω–∏–Ω –ø—Ä–∏ –ø–æ–¥–æ–∑—Ä–µ–Ω–∏–∏ –Ω–∞ –∏–Ω—Ñ–µ–∫—Ü–∏—é',p:'y'},
    {id:'b8',t:'–ü–æ–≤—Ç–æ—Ä–Ω—ã–π –∞–ª—å–±—É–º–∏–Ω ‚Äî –ø—Ä–∏–∑–Ω–∞–∫–∏ 3-–≥–æ –ø—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤–∞',p:'y'}
  ],
  '72h':[
    {id:'c1',t:'–ö–¢ —Å –∫–æ–Ω—Ç—Ä–∞—Å—Ç–æ–º (mCTSI) ‚Äî –æ—Ü–µ–Ω–∫–∞ –Ω–µ–∫—Ä–æ–∑–∞',p:'r'},
    {id:'c2',t:'–ü–µ—Ä–µ—Å—á—ë—Ç SOFA ‚Äî –æ—Ä–≥–∞–Ω–Ω–∞—è –¥–∏—Å—Ñ—É–Ω–∫—Ü–∏—è',p:'r'},
    {id:'c3',t:'–û–ê–ö + –∫–æ–∞–≥—É–ª–æ–≥—Ä–∞–º–º–∞ (–ú–ù–û, —Ñ–∏–±—Ä–∏–Ω–æ–≥–µ–Ω)',p:'r'},
    {id:'c4',t:'–ü—Ä–æ–∫–∞–ª—å—Ü–∏—Ç–æ–Ω–∏–Ω + –ø–æ—Å–µ–≤—ã –ø—Ä–∏ –ª–∏—Ö–æ—Ä–∞–¥–∫–µ',p:'r'},
    {id:'c5',t:'–≠—Ö–æ–ö–ì –ø—Ä–∏ –≥–µ–º–æ–¥–∏–Ω–∞–º–∏—á–µ—Å–∫–æ–π –Ω–µ—Å—Ç–∞–±–∏–ª—å–Ω–æ—Å—Ç–∏',p:'y'},
    {id:'c6',t:'–¢–ê–ü –ø–æ–¥ –ö–¢ –ø—Ä–∏ –ø–æ–¥–æ–∑—Ä–µ–Ω–∏–∏ –Ω–∞ –∏–Ω—Ñ–∏—Ü–∏—Ä–æ–≤–∞–Ω–∏–µ',p:'y'},
    {id:'c7',t:'–û—Ü–µ–Ω–∫–∞ –Ω—É—Ç—Ä–∏—Ç–∏–≤–Ω–æ–≥–æ —Å—Ç–∞—Ç—É—Å–∞, —ç–Ω—Ç–µ—Ä–∞–ª—å–Ω–æ–µ –ø–∏—Ç–∞–Ω–∏–µ',p:'y'},
    {id:'c8',t:'–ö–©–° –ø—Ä–∏ –¥—ã—Ö–∞—Ç–µ–ª—å–Ω–æ–π –Ω–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ—Å—Ç–∏',p:'y'}
  ]
};
function pageRem(){
  return '<div class="fi-anim">'+
  ['24h','48h','72h'].map(function(tp){
    var items=REMS[tp];
    var done=items.filter(function(i){return ST.rem[tp+i.id];}).length;
    var pct=Math.round(done/items.length*100);
    return '<div class="card" style="margin-bottom:11px">'+
      '<div class="ch" style="justify-content:space-between;flex-wrap:wrap;gap:6px">'+
        '<span style="font-family:\'Courier New\';font-size:15px;font-weight:700;color:var(--c)">'+tp+'</span>'+
        '<span class="ct">'+{24:'–ü—Ä–∏ –ø–æ—Å—Ç—É–ø–ª–µ–Ω–∏–∏',48:'–ü–µ—Ä–≤—ã–µ —Å—É—Ç–∫–∏',72:'–í—Ç–æ—Ä—ã–µ —Å—É—Ç–∫–∏'}[parseInt(tp)]+'</span>'+
        '<div style="display:flex;align-items:center;gap:7px;margin-left:auto">'+
          '<span style="font-size:11px;color:var(--t3)">'+done+'/'+items.length+'</span>'+
          '<div style="width:70px;height:4px;background:var(--bd);border-radius:2px;overflow:hidden">'+
            '<div style="height:100%;width:'+pct+'%;background:'+(pct===100?'var(--g)':'var(--c)')+'"></div>'+
          '</div>'+
          '<span style="font-size:11px;color:'+(pct===100?'var(--g)':'var(--c)')+';font-weight:700">'+pct+'%</span>'+
        '</div>'+
      '</div>'+
      items.map(function(item){
        var k=tp+item.id,dn=!!ST.rem[k];
        var pc=item.p==='r'?'var(--r)':item.p==='y'?'var(--y)':'var(--b)';
        return '<div class="ri'+(dn?' dn':'')+'" style="border-left-color:'+(dn?'var(--g)':pc)+'" onclick="ST.rem[\''+k+'\']=!ST.rem[\''+k+'\'];R()">'+
          '<div class="ric">'+(dn?'<span style="font-size:11px;color:#000">‚úì</span>':'')+'</div>'+
          '<span class="rit">'+item.t+'</span>'+
          '<span class="rip" style="background:'+pc+'"></span>'+
        '</div>';
      }).join('')+
    '</div>';
  }).join('')+
  nav2('‚Üê –ù–∞–∑–∞–¥','–î—Ä–µ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ ‚Üí')+
  '</div>';
}

// ‚îÄ‚îÄ –î–†–ï–ù–ò–†–û–í–ê–ù–ò–ï ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
function pageDrain(){
  var ds=ST.dr;
  var steps=[];
  if(ds.inf){
    steps.push({ico:'üíä',lbl:'–®–ê–ì 1: –ê–Ω—Ç–∏–±–∏–æ—Ç–∏–∫–æ—Ç–µ—Ä–∞–ø–∏—è',det:'–ö–∞—Ä–±–∞–ø–µ–Ω–µ–º—ã (–º–µ—Ä–æ–ø–µ–Ω–µ–º 1–≥ √ó 3/—Å—É—Ç) –∏–ª–∏ —Ñ—Ç–æ—Ä—Ö–∏–Ω–æ–ª–æ–Ω—ã + –º–µ—Ç—Ä–æ–Ω–∏–¥–∞–∑–æ–ª. –ù–∞—á–∞—Ç—å –Ω–µ–º–µ–¥–ª–µ–Ω–Ω–æ –ø—Ä–∏ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥—ë–Ω–Ω–æ–º –∏–Ω—Ñ–∏—Ü–∏—Ä–æ–≤–∞–Ω–∏–∏.',urgent:true});
    if(ds.timing==='early'){
      steps.push({ico:'‚è≥',lbl:'–®–ê–ì 2: –û—Ç—Å—Ä–æ—á–∏—Ç—å –∏–Ω–≤–∞–∑–∏—é ‚â•4 –Ω–µ–¥',det:'–í—ã–∂–¥–∞—Ç—å —Ñ–æ—Ä–º–∏—Ä–æ–≤–∞–Ω–∏–µ WON (–æ—Ç–≥—Ä–∞–Ω–∏—á–µ–Ω–Ω–æ–≥–æ –Ω–µ–∫—Ä–æ–∑–∞). –ê–≥—Ä–µ—Å—Å–∏–≤–Ω–∞—è –∫–æ–Ω—Å–µ—Ä–≤–∞—Ç–∏–≤–Ω–∞—è —Ç–µ—Ä–∞–ø–∏—è. –≠–Ω—Ç–µ—Ä–∞–ª—å–Ω–æ–µ –ø–∏—Ç–∞–Ω–∏–µ (–Ω–∞–∑–æ–µ—é–Ω–∞–ª—å–Ω—ã–π –∑–æ–Ω–¥).',urgent:false});
      steps.push({ico:'üîµ',lbl:'–®–ê–ì 3: –ß–ö–î –∫–∞–∫ bridge-—Ç–µ—Ä–∞–ø–∏—è',det:'–ß—Ä–µ—Å–∫–æ–∂–Ω–æ–µ –¥—Ä–µ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ –ø—Ä–∏ —Å–µ–ø—Å–∏—Å–µ / –∫–ª–∏–Ω. —É—Ö—É–¥—à–µ–Ω–∏–∏. –ö–∞—Ç–µ—Ç–µ—Ä 12‚Äì16 Fr, –ö–¢/–£–ó-–Ω–∞–≤–µ–¥–µ–Ω–∏–µ. –í—Ä–µ–º–µ–Ω–Ω–∞—è –º–µ—Ä–∞ –¥–æ –Ω–µ–∫—Ä—ç–∫—Ç–æ–º–∏–∏.',urgent:ds.stab==='unstable'});
    } else {
      if(ds.loc==='perigastric'){
        steps.push({ico:'üéØ',lbl:'–®–ê–ì 2: EUS-–¥—Ä–µ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ —Ç—Ä–∞–Ω—Å–≥–∞—Å—Ç—Ä–∞–ª—å–Ω–æ–µ',det:'–ú–µ—Ç–æ–¥ –≤—ã–±–æ—Ä–∞ –ø—Ä–∏ –ø–µ—Ä–∏–≥–∞—Å—Ç—Ä–∞–ª—å–Ω–æ–º WON. LAMS-—Å—Ç–µ–Ω—Ç—ã –∏–ª–∏ –ø–ª–∞—Å—Ç–∏–∫–æ–≤—ã–µ. –≠—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ—Å—Ç—å 80‚Äì90%. –ú–∏–Ω–∏–º–∞–ª—å–Ω–æ –∏–Ω–≤–∞–∑–∏–≤–Ω–æ.',urgent:false});
        if(ds.nec==='large') steps.push({ico:'üî¨',lbl:'–®–ê–ì 3: –≠–Ω–¥–æ—Å–∫–æ–ø–∏—á–µ—Å–∫–∞—è –Ω–µ–∫—Ä—ç–∫—Ç–æ–º–∏—è (DEET)',det:'–ü—Ä–∏ –Ω–µ—ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏ –¥—Ä–µ–Ω–∏—Ä–æ–≤–∞–Ω–∏—è. 3‚Äì5 —Å–µ—Å—Å–∏–π —á–µ—Ä–µ–∑ —Ç—Ä–∞–Ω—Å–≥–∞—Å—Ç—Ä–∞–ª—å–Ω—ã–π –¥–æ—Å—Ç—É–ø —Å –∏–Ω—Ç–µ—Ä–≤–∞–ª–æ–º 48‚Äì72 —á.',urgent:false});
      } else {
        steps.push({ico:'üîµ',lbl:'–®–ê–ì 2: –ß—Ä–µ—Å–∫–æ–∂–Ω–æ–µ –¥—Ä–µ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ (–ß–ö–î)',det:'–ü–µ—Ä–≤–∞—è –ª–∏–Ω–∏—è –ø—Ä–∏ —Ä–µ—Ç—Ä–æ–ø–µ—Ä–∏—Ç–æ–Ω–µ–∞–ª—å–Ω–æ–º –Ω–µ–∫—Ä–æ–∑–µ. –ö–¢-–Ω–∞–≤–µ–¥–µ–Ω–∏–µ, –∫–∞—Ç–µ—Ç–µ—Ä 12‚Äì30 Fr. –û—Å—Ç–∞–≤–∏—Ç—å –¥–æ <10 –º–ª/—Å—É—Ç.',urgent:false});
        steps.push({ico:'üé¨',lbl:'–®–ê–ì 3: VARD / MIRPN',det:'–í–∏–¥–µ–æ–∞—Å—Å–∏—Å—Ç–∏—Ä–æ–≤–∞–Ω–Ω–∞—è —Ä–µ—Ç—Ä–æ–ø–µ—Ä–∏—Ç–æ–Ω–µ–∞–ª—å–Ω–∞—è –¥–µ–±—Ä–∏–¥–∞—Ü–∏—è —á–µ—Ä–µ–∑ –¥—Ä–µ–Ω–∞–∂–Ω—ã–π –∫–∞–Ω–∞–ª. Step-up –ø–æ–¥—Ö–æ–¥ (PANTER trial NEJM 2010).',urgent:false});
      }
      if(ds.stab==='unstable'||ds.nec==='large') steps.push({ico:'üè•',lbl:'–®–ê–ì 4: –û—Ç–∫—Ä—ã—Ç–∞—è –Ω–µ–∫—Ä—ç–∫—Ç–æ–º–∏—è',det:'–†–µ–∑–µ—Ä–≤: –Ω–µ—Å—Ç–∞–±–∏–ª—å–Ω–æ—Å—Ç—å –ø—Ä–∏ –ú–ò-–ø–æ–¥—Ö–æ–¥–µ, –º–∞—Å—Å–∏–≤–Ω—ã–π —Å–µ–ø—Å–∏—Å, –∫–∏—à–µ—á–Ω—ã–π —Å–≤–∏—â, –∞—Ä—Ä–æ–∑–∏–≤–Ω–æ–µ –∫—Ä–æ–≤–æ—Ç–µ—á–µ–Ω–∏–µ.',urgent:ds.stab==='unstable'});
    }
  }
  return '<div class="fi-anim">'+
  '<div class="card">'+
    '<div class="ch"><span>ü©∫</span><span class="ct">–ú–µ—Ç–æ–¥ –¥—Ä–µ–Ω–∏—Ä–æ–≤–∞–Ω–∏—è –ø–∞–Ω–∫—Ä–µ–æ–Ω–µ–∫—Ä–æ–∑–∞</span></div>'+
    '<div class="cb">'+
      '<div style="margin-bottom:13px"><div class="sl">–ü—Ä–∏–∑–Ω–∞–∫–∏ –∏–Ω—Ñ–∏—Ü–∏—Ä–æ–≤–∞–Ω–∏—è –Ω–µ–∫—Ä–æ–∑–∞</div>'+
        '<div class="tg">'+
          '<button class="tb'+(ds.inf?' onr':' ong')+'" onclick="ST.dr.inf=!ST.dr.inf;R()">'+
            (ds.inf?'‚ö† –î–∞ ‚Äî –µ—Å—Ç—å –∏–Ω—Ñ–∏—Ü–∏—Ä–æ–≤–∞–Ω–∏–µ':'‚úÖ –ù–µ—Ç ‚Äî —Å—Ç–µ—Ä–∏–ª—å–Ω—ã–π –Ω–µ–∫—Ä–æ–∑')+'</button>'+
        '</div>'+
        '<div class="ib" style="margin-top:7px">–ö–¢: –≥–∞–∑ –≤ –Ω–µ–∫—Ä–æ–∑–µ ¬∑ –õ–∏—Ö–æ—Ä–∞–¥–∫–∞ >38.5¬∞C ¬∑ ‚Üë–ü—Ä–æ–∫–∞–ª—å—Ü–∏—Ç–æ–Ω–∏–Ω ¬∑ –¢–ê–ü-–ø–æ—Å–µ–≤ (+)</div>'+
      '</div>'+
      (ds.inf?
        '<div style="margin-bottom:13px"><div class="sl">–°—Ä–æ–∫ –æ—Ç –Ω–∞—á–∞–ª–∞ –∑–∞–±–æ–ª–µ–≤–∞–Ω–∏—è</div>'+
          '<div class="tg">'+
            '<button class="tb'+(ds.timing==='early'?' on':'')+'" onclick="ST.dr.timing=\'early\';R()">‚è± –†–∞–Ω–Ω–∏–π (&lt;4 –Ω–µ–¥) ‚Äî –ù–ê–ù–ü</button>'+
            '<button class="tb'+(ds.timing==='late'?' on':'')+'" onclick="ST.dr.timing=\'late\';R()">üìÖ –ü–æ–∑–¥–Ω–∏–π (‚â•4 –Ω–µ–¥) ‚Äî WON</button>'+
          '</div>'+
        '</div>'+
        '<div style="margin-bottom:13px"><div class="sl">–õ–æ–∫–∞–ª–∏–∑–∞—Ü–∏—è –Ω–µ–∫—Ä–æ–∑–∞</div>'+
          '<div class="tg">'+
            '<button class="tb'+(ds.loc==='perigastric'?' on':'')+'" onclick="ST.dr.loc=\'perigastric\';R()">üéØ –ü–µ—Ä–∏–≥–∞—Å—Ç—Ä–∞–ª—å–Ω—ã–π / —Ü–µ–Ω—Ç—Ä–∞–ª—å–Ω—ã–π</button>'+
            '<button class="tb'+(ds.loc==='retroperitoneal'?' on':'')+'" onclick="ST.dr.loc=\'retroperitoneal\';R()">üîµ –†–µ—Ç—Ä–æ–ø–µ—Ä–∏—Ç–æ–Ω–µ–∞–ª—å–Ω—ã–π / —Ö–≤–æ—Å—Ç</button>'+
          '</div>'+
        '</div>'+
        '<div style="margin-bottom:13px"><div class="sl">–û–±—ä—ë–º –Ω–µ–∫—Ä–æ–∑–∞</div>'+
          '<div class="tg">'+
            '<button class="tb'+(ds.nec==='small'?' on':'')+'" onclick="ST.dr.nec=\'small\';R()">&lt;50% –ü–ñ</button>'+
            '<button class="tb'+(ds.nec==='large'?' onr':'')+'" onclick="ST.dr.nec=\'large\';R()">‚â•50% –ü–ñ ‚ö†</button>'+
          '</div>'+
        '</div>'+
        '<div><div class="sl">–ì–µ–º–æ–¥–∏–Ω–∞–º–∏–∫–∞</div>'+
          '<div class="tg">'+
            '<button class="tb'+(ds.stab==='stable'?' ong':'')+'" onclick="ST.dr.stab=\'stable\';R()">‚úÖ –°—Ç–∞–±–∏–ª—å–Ω–∞</button>'+
            '<button class="tb'+(ds.stab==='unstable'?' onr':'')+'" onclick="ST.dr.stab=\'unstable\';R()">üö® –ù–µ—Å—Ç–∞–±–∏–ª—å–Ω–∞</button>'+
          '</div>'+
        '</div>'
      :'')+
    '</div>'+
  '</div>'+
  (!ds.inf?'<div class="al al-g"><b>‚úÖ –ü—Ä–∏–∑–Ω–∞–∫–æ–≤ –∏–Ω—Ñ–∏—Ü–∏—Ä–æ–≤–∞–Ω–∏—è –Ω–µ—Ç.</b> –ö–æ–Ω—Å–µ—Ä–≤–∞—Ç–∏–≤–Ω–æ–µ –ª–µ—á–µ–Ω–∏–µ. –≠–Ω—Ç–µ—Ä–∞–ª—å–Ω–æ–µ –ø–∏—Ç–∞–Ω–∏–µ. –ò–Ω–≤–∞–∑–∏—è –ø—Ä–∏ —Å—Ç–µ—Ä–∏–ª—å–Ω–æ–º –Ω–µ–∫—Ä–æ–∑–µ ‚Äî —Ç–æ–ª—å–∫–æ –ø—Ä–∏ —Ä–µ—Ñ—Ä–∞–∫—Ç–µ—Ä–Ω—ã—Ö —Å–∏–º–ø—Ç–æ–º–∞—Ö –ø–æ—Å–ª–µ ‚â•4 –Ω–µ–¥–µ–ª—å.</div>':'')+
  steps.map(function(s,i){
    return '<div class="ds" style="border-color:'+(s.urgent?'var(--r)44':'var(--bd)')+';border-left:4px solid '+(s.urgent?'var(--r)':'var(--c)')+';background:'+(s.urgent?'#ef434308':'var(--bg2)')+';animation-delay:'+(i*0.07)+'s">'+
      '<div class="di" style="background:'+(s.urgent?'var(--r)20':'var(--c)15')+';border:1px solid '+(s.urgent?'var(--r)44':'var(--c)33')+'">'+s.ico+'</div>'+
      '<div style="flex:1"><div class="dl" style="color:'+(s.urgent?'var(--r)':'var(--t)')+'">'+s.lbl+(s.urgent?'<span class="ub">–°–†–û–ß–ù–û</span>':'')+'</div>'+
      '<div class="dd">'+s.det+'</div></div>'+
    '</div>';
  }).join('')+
  (steps.length?'<div class="ib">üìö IAP/APA 2013 ¬∑ ESGE 2018 ¬∑ Step-up approach (van Santvoort NEJM 2010) ¬∑ WSES 2019</div>':'')+
  nav2('‚Üê –ù–∞–∑–∞–¥','–û–±—ä—ë–º –≤–º–µ—à–∞—Ç–µ–ª—å—Å—Ç–≤–∞ ‚Üí')+
  '</div>';
}

// ‚îÄ‚îÄ –ö–ê–õ–¨–ö–£–õ–Ø–¢–û–† –û–ë–™–Å–ú–ê –í–ú–ï–®–ê–¢–ï–õ–¨–°–¢–í–ê ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
function pageSurg(){
  var sg=ST.surg;
  // –°—á–∏—Ç–∞–µ–º —Å—É–º–º—É
  var vals=[sg.gender,sg.necrosis,sg.character,sg.wall,sg.crp,sg.failure,sg.volume];
  var allFilled=vals.every(function(v){return v!=='';});
  var total=vals.reduce(function(a,v){return a+(parseInt(v)||0);},0);

  var res=null;
  if(allFilled){
    if(total<15) res={c:'g',lbl:'–ù–µ –±–æ–ª–µ–µ 2 –¥—Ä–µ–Ω–∞–∂–µ–π',ico:'üîµ',sub:'–ú–∏–Ω–∏–º–∞–ª—å–Ω–∞—è –∏–Ω–≤–∞–∑–∏—è'};
    else if(total<30) res={c:'y',lbl:'–≠–Ω–¥–æ—Å–∫–æ–ø–∏—è –∏/–∏–ª–∏ 3‚Äì4 –¥—Ä–µ–Ω–∞–∂–∞',ico:'üéØ',sub:'–≠–Ω–¥–æ—Å–∫–æ–ø–∏—á–µ—Å–∫–æ–µ –≤–º–µ—à–∞—Ç–µ–ª—å—Å—Ç–≤–æ'};
    else if(total<50) res={c:'y',lbl:'4‚Äì5 –¥—Ä–µ–Ω–∞–∂–µ–π / SEMS / —ç–Ω–¥–æ—Å–∫–æ–ø–∏—è',ico:'üî¨',sub:'–†–∞—Å—à–∏—Ä–µ–Ω–Ω–∞—è –∏–Ω–≤–∞–∑–∏—è'};
    else res={c:'r',lbl:'VARD / –æ—Ç–∫—Ä—ã—Ç—ã–π –¥–æ—Å—Ç—É–ø',ico:'üè•',sub:'–ú–∞–∫—Å–∏–º–∞–ª—å–Ω–∞—è –∏–Ω–≤–∞–∑–∏—è'};
  }
  var resC=res?(res.c==='g'?'var(--g)':res.c==='y'?'var(--y)':'var(--r)'):'var(--bd)';

  function surgSel(lbl,sub,key,opts){
    return '<div class="surg-item">'+
      '<div class="surg-lbl">'+lbl+'</div>'+
      (sub?'<div class="surg-sub">'+sub+'</div>':'')+
      '<select class="surg-sel" onchange="ST.surg[\''+key+'\']=this.value;R()">'+
        '<option value="">‚Äî –í—ã–±–µ—Ä–∏—Ç–µ ‚Äî</option>'+
        opts.map(function(o){return '<option value="'+o[0]+'"'+(sg[key]===o[0]?' selected':'')+'>'+o[1]+'</option>';}).join('')+
      '</select>'+
    '</div>';
  }

  return '<div class="fi-anim">'+
  '<div class="card">'+
    '<div class="ch"><span>üè•</span><span class="ct">–ö–∞–ª—å–∫—É–ª—è—Ç–æ—Ä –æ–±—ä—ë–º–∞ —Ö–∏—Ä—É—Ä–≥–∏—á–µ—Å–∫–æ–≥–æ –≤–º–µ—à–∞—Ç–µ–ª—å—Å—Ç–≤–∞ –ø—Ä–∏ –ø–∞–Ω–∫—Ä–µ–æ–Ω–µ–∫—Ä–æ–∑–µ</span></div>'+
    '<div class="cb">'+
      '<div class="al al-i">–®–∫–∞–ª–∞ –±–∞–ª—å–Ω–æ–π –æ—Ü–µ–Ω–∫–∏ –¥–ª—è –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è –æ–ø—Ç–∏–º–∞–ª—å–Ω–æ–≥–æ –º–µ—Ç–æ–¥–∞ –¥—Ä–µ–Ω–∏—Ä–æ–≤–∞–Ω–∏—è</div>'+

      surgSel('–ü–æ–ª –ø–∞—Ü–∏–µ–Ω—Ç–∞','',
        'gender',[['0','–ñ–µ–Ω—Å–∫–∏–π (0 –±)'],['10','–ú—É–∂—Å–∫–æ–π (10 –±)']])+

      surgSel('–û–±—ä—ë–º –Ω–µ–∫—Ä–æ–∑–∞ –ø–æ–¥–∂–µ–ª—É–¥–æ—á–Ω–æ–π –∂–µ–ª–µ–∑—ã','',
        'necrosis',[['0','–ú–µ–Ω–µ–µ 30% (0 –±)'],['5','30‚Äì50% (5 –±)'],['8','–ë–æ–ª–µ–µ 50% (8 –±)']])+

      surgSel('–•–∞—Ä–∞–∫—Ç–µ—Ä —Å–∫–æ–ø–ª–µ–Ω–∏–π –∂–∏–¥–∫–æ—Å—Ç–∏','',
        'character',[['0','–ì–æ–º–æ–≥–µ–Ω–Ω—ã–π (0 –±)'],['10','–ì–µ—Ç–µ—Ä–æ–≥–µ–Ω–Ω—ã–π (10 –±)']])+

      surgSel('–ù–∞–ª–∏—á–∏–µ –æ—Ç–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è (—Å—Ç–µ–Ω–∫–∏)','',
        'wall',[
          ['0','–°—Ç–µ–Ω–∫–∞ –Ω–µ –≤–∏–∑—É–∞–ª–∏–∑–∏—Ä—É–µ—Ç—Å—è (0 –±)'],
          ['5','–¢–æ–Ω–∫–∞—è —Å—Ç–µ–Ω–∫–∞ (5 –±)'],
          ['10','–û—Ñ–æ—Ä–º–ª–µ–Ω–Ω–∞—è —Å—Ç–µ–Ω–∫–∞ —Å —Å–µ–∫–≤–µ—Å—Ç—Ä–æ–º (10 –±)']
        ])+

      surgSel('–°–†–ë (–°-—Ä–µ–∞–∫—Ç–∏–≤–Ω—ã–π –±–µ–ª–æ–∫)','–º–≥/–ª',
        'crp',[
          ['2','–ú–µ–Ω–µ–µ 50 –º–≥/–ª (2 –±)'],
          ['8','50‚Äì100 –º–≥/–ª (8 –±)'],
          ['10','–ë–æ–ª–µ–µ 100 –º–≥/–ª (10 –±)'],
          ['12','–ù–∞—Ä–∞—Å—Ç–∞–Ω–∏–µ >20 –º–≥/–ª (12 –±)']
        ])+

      surgSel('–û—Ä–≥–∞–Ω–Ω–∞—è –Ω–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ—Å—Ç—å','–ú–æ–Ω–æ- –∏–ª–∏ –ø–æ–ª–∏–æ—Ä–≥–∞–Ω–Ω–∞—è',
        'failure',[['0','–ù–µ—Ç (0 –±)'],['12','–ï—Å—Ç—å (12 –±)']])+

      surgSel('–û–±—ä—ë–º –∑–∞–±—Ä—é—à–∏–Ω–Ω–æ–≥–æ —Å–∫–æ–ø–ª–µ–Ω–∏—è','–Ω–∞–∏–±–æ–ª—å—à–∏–π —Ä–∞–∑–º–µ—Ä',
        'volume',[
          ['2','–ú–µ–Ω–µ–µ 10 —Å–º (2 –±)'],
          ['5','10‚Äì15 —Å–º (5 –±)'],
          ['8','–ë–æ–ª–µ–µ 15 —Å–º (8 –±)']
        ])+

      // –ü—Ä–æ–≥—Ä–µ—Å—Å-–±–∞—Ä
      '<div style="margin:14px 0 8px;display:flex;justify-content:space-between;font-size:11px;color:var(--t3)">'+
        '<span>–ó–∞–ø–æ–ª–Ω–µ–Ω–æ: '+vals.filter(function(v){return v!=='';}).length+' / 7</span>'+
        (allFilled?'<span style="color:var(--c)">–°—á—ë—Ç: '+total+' –±–∞–ª–ª–æ–≤</span>':'')+
      '</div>'+
      '<div style="height:5px;background:var(--bd);border-radius:3px;overflow:hidden;margin-bottom:14px">'+
        '<div style="height:100%;width:'+(vals.filter(function(v){return v!=='';}).length/7*100)+'%;background:var(--c);transition:.3s"></div>'+
      '</div>'+

      // –†–µ–∑—É–ª—å—Ç–∞—Ç
      (allFilled?
        '<div class="score-big" style="border-color:'+resC+'55;background:'+resC+'12">'+
          '<div class="score-num" style="color:'+resC+'">'+total+'</div>'+
          '<div style="font-size:11px;color:var(--t2);margin-top:2px">–±–∞–ª–ª–æ–≤</div>'+
          '<div class="score-lbl" style="color:'+resC+'">'+res.ico+' '+res.lbl+'</div>'+
          '<div class="score-rec">'+res.sub+'</div>'+
          '<div style="margin-top:12px;font-size:11px;color:var(--t2);line-height:1.7">'+
            (total<15?'–ú–∞–ª–æ–∏–Ω–≤–∞–∑–∏–≤–Ω–æ–µ —á—Ä–µ—Å–∫–æ–∂–Ω–æ–µ –¥—Ä–µ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ. 1‚Äì2 –¥—Ä–µ–Ω–∞–∂–∞ –¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –¥–ª—è —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ–π —Å–∞–Ω–∞—Ü–∏–∏.':
             total<30?'–†–µ–∫–æ–º–µ–Ω–¥–æ–≤–∞–Ω–æ —ç–Ω–¥–æ—Å–∫–æ–ø–∏—á–µ—Å–∫–æ–µ –≤–º–µ—à–∞—Ç–µ–ª—å—Å—Ç–≤–æ (EUS) –∏/–∏–ª–∏ —É—Å—Ç–∞–Ω–æ–≤–∫–∞ 3‚Äì4 –¥—Ä–µ–Ω–∞–∂–µ–π —Å –∞–¥–µ–∫–≤–∞—Ç–Ω—ã–º –∫–æ–Ω—Ç—Ä–æ–ª–µ–º.':
             total<50?'4‚Äì5 –¥—Ä–µ–Ω–∞–∂–µ–π, —Ä–∞—Å—Å–º–æ—Ç—Ä–µ—Ç—å –º–µ—Ç–∞–ª–ª–∏—á–µ—Å–∫–∏–µ —Å—Ç–µ–Ω—Ç—ã (SEMS) –∏–ª–∏ –ª–∞–ø–∞—Ä–æ—Å–∫–æ–ø–∏—á–µ—Å–∫—É—é –Ω–µ–∫—Ä—ç–∫—Ç–æ–º–∏—é.':
             '–û—Ç–∫—Ä—ã—Ç—ã–π —Ö–∏—Ä—É—Ä–≥–∏—á–µ—Å–∫–∏–π –¥–æ—Å—Ç—É–ø –∏–ª–∏ VARD. –í—ã—Å–æ–∫–∏–π —Ä–∏—Å–∫ –ø–æ—Å–ª–µ–æ–ø–µ—Ä–∞—Ü–∏–æ–Ω–Ω—ã—Ö –æ—Å–ª–æ–∂–Ω–µ–Ω–∏–π. –û–†–ò–¢ –æ–±—è–∑–∞—Ç–µ–ª–µ–Ω.')+
          '</div>'+
          '<div style="margin-top:10px;padding-top:10px;border-top:1px solid '+resC+'33;font-size:10px;color:var(--t3);text-align:left">'+
            '<b>–ü–æ—Ä–æ–≥–∏:</b> &lt;15 –± ‚Äî ‚â§2 –¥—Ä–µ–Ω–∞–∂–∞ ¬∑ 15‚Äì29 ‚Äî —ç–Ω–¥–æ—Å–∫–æ–ø–∏—è/3‚Äì4 –¥—Ä–µ–Ω–∞–∂–∞ ¬∑ 30‚Äì49 ‚Äî SEMS/4‚Äì5 –¥—Ä–µ–Ω–∞–∂–µ–π ¬∑ ‚â•50 ‚Äî VARD/–æ—Ç–∫—Ä—ã—Ç—ã–π'+
          '</div>'+
        '</div>'
      :
        '<div style="text-align:center;padding:20px;color:var(--t3);font-size:13px">–ó–∞–ø–æ–ª–Ω–∏—Ç–µ –≤—Å–µ 7 –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ –¥–ª—è —Ä–∞—Å—á—ë—Ç–∞</div>'
      )+
    '</div>'+
  '</div>'+
  nav2('‚Üê –î—Ä–µ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ',
    '<button class="btn btn-p" onclick="newPatient()" style="margin-left:0">üîÑ –ù–æ–≤—ã–π –ø–∞—Ü–∏–µ–Ω—Ç</button>')+
  '</div>';
}

function newPatient(){
  ST={step:0,tp:'24h',
    diag:{pain:false,enzymes:false,imaging:false,amylase:'',lipase:'',imgType:''},
    etio:'',onset:'',onsetT:'',
    pat:{age:'',weight:'',chronicYes:false,chronic:'none'},
    data:{'24h':{},'48h':{},'72h':{}},
    rem:{},
    dr:{inf:false,timing:'late',loc:'perigastric',nec:'small',stab:'stable'},
    surg:{gender:'',necrosis:'',character:'',wall:'',crp:'',failure:'',volume:''}
  };
  renderContent();
  window.scrollTo(0,0);
}

// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
// HELPERS –î–õ–Ø –ì–ï–ù–ï–†–ê–¶–ò–ò –ü–û–õ–ï–ô
// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
function tpTabs(){
  return '<div class="tpt">'+
    '<span style="font-size:11px;color:var(--t3);align-self:center;text-transform:uppercase;letter-spacing:.06em;margin-right:3px">–ß–∞—Å—ã:</span>'+
    ['24h','48h','72h'].map(function(t){
      return '<button class="tpb'+(ST.tp===t?' on':'')+'" onclick="ST.tp=\''+t+'\';R()">'+t+'</button>';
    }).join('')+
  '</div>';
}
function nav2(lb,nb){
  // nb –º–æ–∂–µ—Ç –±—ã—Ç—å —Å—Ç—Ä–æ–∫–æ–π-HTML –∏–ª–∏ —Ç–µ–∫—Å—Ç–æ–º
  var nbHtml=nb.indexOf('<button')>=0?nb:'<button class="btn btn-p" onclick="next()">'+nb+'</button>';
  return '<div class="btnrow">'+
    '<button class="btn btn-s" onclick="back()">'+lb+'</button>'+
    nbHtml+
  '</div>';
}

// –ü–æ–ª–µ –≤–≤–æ–¥–∞ —á–∏—Å–ª–∞ ‚Äî oninput –¢–û–õ–¨–ö–û —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç, onblur –ø–µ—Ä–µ—Ä–∏—Å–æ–≤—ã–≤–∞–µ—Ç
function dInp(lbl,tp,key,unit,opts){
  opts=opts||{};
  var val=D(tp)[key]||'';
  var extra=(opts.min?' min="'+opts.min+'"':'')+(opts.max?' max="'+opts.max+'"':'')+(opts.step?' step="'+opts.step+'"':' step="any"');
  return '<div class="fl"><div class="flb">'+lbl+'</div>'+
    '<div class="fw">'+
      '<input class="fi'+(unit?' u':'')+'" type="text" inputmode="decimal" placeholder="‚Äî" value="'+val+'" '+extra+
        ' oninput="sD(\''+tp+'\',\''+key+'\',this.value)"'+
        ' onblur="onBlur()"'+
        ' onfocus="this.select()">'+
      (unit?'<span class="fu">'+unit+'</span>':'')+
    '</div></div>';
}

// –ü–æ–ª–µ select –¥–ª—è –¥–∞–Ω–Ω—ã—Ö
function dSel(lbl,tp,key,opts){
  var val=D(tp)[key]||opts[0][0];
  return '<div class="fl"><div class="flb">'+lbl+'</div>'+
    '<select class="fsel" onchange="sDR(\''+tp+'\',\''+key+'\',this.value)">'+
      opts.map(function(o){return '<option value="'+o[0]+'"'+(val===o[0]?' selected':'')+'>'+o[1]+'</option>';}).join('')+
    '</select></div>';
}

// –ü–æ–ª–µ —Å unit –¥–ª—è –¥–∏–∞–≥–Ω–æ–∑–∞/–ø–∞—Ü–∏–µ–Ω—Ç–∞ ‚Äî —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç –Ω–∞ input, –ø–µ—Ä–µ—Ä–∏—Å–æ–≤—ã–≤–∞–µ—Ç –Ω–∞ blur
function inpUnit(lbl,type,id,val,unit,oninput,onblur,hint){
  return '<div class="fl"><div class="flb">'+lbl+'</div>'+
    '<div class="fw">'+
      '<input class="fi u" type="text" inputmode="decimal" id="'+id+'" placeholder="‚Äî" value="'+val+'"'+
        ' oninput="'+oninput+'"'+
        ' onblur="'+onblur+'"'+
        ' onfocus="this.select()">'+
      '<span class="fu">'+unit+'</span>'+
    '</div>'+
    (hint?'<div class="fconv">'+hint+'</div>':'')+
  '</div>';
}

// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
// INIT
// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
R();
</script>
</body>
</html>
